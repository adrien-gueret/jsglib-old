/*!
 * RGB: Really Great Ball, JavaScript Game (minified)
 * Made with GameBuilder : http://gamebuilder.no-ip.org/
 *
 * Copyright 2011-2012, Adrien GuÃ©ret
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * 
 * Date: 25/10/2012
 */

Game.addClass({name:"Ball",updateColors:function(){var a="";this.hasColor(Ball.R)?(Game.red.style.opacity=1,Game.red.innerHTML="",a+=" red"):(Game.red.style.opacity=0.2,Game.red.innerHTML="&Chi;");this.hasColor(Ball.G)?(Game.green.style.opacity=1,Game.green.innerHTML="",a+=" green"):(Game.green.style.opacity=0.2,Game.green.innerHTML="&Chi;");this.hasColor(Ball.B)?(Game.blue.style.opacity=1,Game.blue.innerHTML="",a+=" blue"):(Game.blue.style.opacity=0.2,Game.blue.innerHTML="&Chi;");Game.color.className= "tache"+a;Game.borders.className="change"+a;Game.titleLevel.className="change"+a;Game.credits.className="change"+a},gainCouleur:function(a){var b=!1,c;for(c in a)this.hasColor(a[c])||(this.colors[a[c]]=Ball.PLEIN,b=!0);if(b){Game.playSound("splash");b=Game.instanceCreate(this.x-18.5,this.y-18,Splash);b.ball=this;switch(a.length){case 1:b.sprite.tiles=[4*a[0]+1];break;case 2:b.sprite.tiles=[21-4*(3-a[0]-a[1])];break;default:b.sprite.tiles=[25]}for(c=1;4>c;c++)b.sprite.tiles.push(b.sprite.tiles[0]+ c);this.updateColors()}},perdCouleur:function(a){var b=!1,c;for(c in a)this.hasColor(a[c])&&(this.colors[a[c]]=Ball.VIDE,b=!0);if(b){Game.playSound("absorb");b=Game.instanceCreate(this.x,this.y-16,Bubble);b.ball=this;switch(a.length){case 1:b.sprite.tiles=[5*a[0]+1];break;case 2:b.sprite.tiles=[26-5*(3-a[0]-a[1])];break;default:b.sprite.tiles=[31]}for(c=1;5>c;c++)b.sprite.tiles.push(b.sprite.tiles[0]+c);this.updateColors()}},darker:function(a){var b=[];b.push(Math.round(0.8*a[0]));b.push(Math.round(0.8* a[1]));b.push(Math.round(0.8*a[2]));return b},isColor:function(a){for(var b in a)if(a[b]!=this.colors[b])return!1;return!0},hasColor:function(a){return this.colors[a]==Ball.PLEIN},draw:function(){var a=this.darker(this.colors),b=this.darker(a);this.drawCircle({x:this.x-Game.room.view_x+this.sprite.width/2,y:this.y-Game.room.view_y+this.sprite.height/2,radius:15,color:"transparent",borderColor:"rgb("+b.join(",")+")",borderLength:1});this.drawCircle({x:this.x-Game.room.view_x+this.sprite.width/2,y:this.y- Game.room.view_y+this.sprite.height/2,radius:14,color:"rgb("+this.colors.join(",")+")",borderColor:"rgb("+a.join(",")+")",borderLength:3});this.drawSprite({sprite:this.sprite,x:this.x-Game.room.view_x,y:this.y-Game.room.view_y})},eventCreate:function(){this.sprite=new Sprite(Game.getImage("yeux"));this.sprite.makeTiles(32,32,1);this.state=Element.STATE_STAND_RIGHT;this.endLevel=this.fall=!1;this.colors=[Ball.VIDE,Ball.VIDE,Ball.VIDE];this.setZIndex(500);Game.ball=this},eventEndStep:function(){this.endLevel|| (this.vspeed=Math.min(this.vspeed,10),!0!==Game.placeIsFree(this.x,this.y,this.sprite.width,this.sprite.height+1)?(this.gravity=this.vspeed=0,this.fall=!1):this.gravity=0>this.vspeed?0.7:2)},eventStartStep:function(){if(this.endLevel){var a=this.instanceNearest(End);parseInt(this.x,10)!=a.x||parseInt(this.y,10)!=a.y?this.moveToPoint(a.x,a.y,0.7):this.vspeed=this.hspeed=0}else switch(this.state){case Element.STATE_STAND_RIGHT:this.sprite.tiles=[2];break;case Element.STATE_STAND_LEFT:this.sprite.tiles= [5];break;case Element.STATE_MOVE_RIGHT:this.sprite.tiles=[1,2,3,2];break;case Element.STATE_MOVE_LEFT:this.sprite.tiles=[4,5,6,5]}},eventStep:function(){if(!this.endLevel){this.x=Math.max(0,Math.min(this.x,Game.room.width-this.sprite.width));this.y=Math.min(this.y,Game.room.height-this.sprite.height);if(0>this.vspeed&&(Game.isKeyPressed(Game.KEY_SPACE)||Game.isKeyPressed(Game.KEY_UP))&&!this.fall)-6.4<this.vspeed?this.vspeed-=1.05:this.fall=!0;Game.canvas.style.backgroundPosition=-(Game.room.view_x/ 3)+"px "+(-(Game.room.view_y/3)+"px")}this.draw()},eventKeyPressed:function(a){switch(a){case Game.KEY_RIGHT:return this.endLevel||(this.state=Element.STATE_MOVE_RIGHT,this.hspeed=4),!1;case Game.KEY_LEFT:return this.endLevel||(this.state=Element.STATE_MOVE_LEFT,this.hspeed=-4),!1;case Game.KEY_UP:case Game.KEY_DOWN:case Game.KEY_SPACE:return!1}},eventKeyDown:function(a){switch(a){case Game.KEY_UP:case Game.KEY_SPACE:return!this.endLevel&&(!0!==Game.placeIsFree(this.x,this.y,this.sprite.width,this.sprite.height+ 1)&&!0===Game.placeIsFree(this.x,this.y-1,this.sprite.width,1))&&(Game.playSound("jump"),this.vspeed=-5),!1;case Game.KEY_R:return this.endLevel||Game.restartRoom(),!1;case Game.KEY_CONTROL:return this.endLevel||Game.toggleSounds(),!1}},eventKeyUp:function(a){if(!this.endLevel)if(0>this.hspeed&&a==Game.KEY_LEFT||0<this.hspeed&&a==Game.KEY_RIGHT)this.state=0>this.hspeed?Element.STATE_STAND_LEFT:Element.STATE_STAND_RIGHT,this.hspeed=0;else if(a==Game.KEY_UP||a==Game.KEY_SPACE)this.fall=!0},eventRoomStart:function(){Game.room.viewLink= this;Game.room.background_hspeed=0.6;Game.room.background_vspeed=0.6;Game.titleLevel.innerHTML="Niveau "+Game.room.id;Game.red&&this.updateColors()}});Ball.VIDE=80;Ball.PLEIN=240;Ball.R=0;Ball.G=1;Ball.B=2; Game.addClass({name:"Paint","abstract":!0,eventCreate:function(){this.sprite=new Sprite(Game.getImage("peinture"));this.sprite.makeTiles(32,32,1);this.sprite.imagespeed=0;for(var a=1;8>=a;a++)this.sprite.setMask(a,{x:5,y:6,width:23,height:25});this.collideSolid=!1;this.color=[];this.setZIndex(100)},eventCollisionWith:function(a){a.instanceOf(Ball)&&a.gainCouleur(this.color)},eventOutsideView:function(){this.setActive(!1)},eventInsideView:function(){this.setActive(!0)}}); Game.addClass({name:"RPaint",parent:"Paint",eventCreate:function(){this.callParent("eventCreate");this.sprite.tiles=[1];this.color=[Ball.R]}});Game.addClass({name:"GPaint",parent:"Paint",eventCreate:function(){this.callParent("eventCreate");this.sprite.tiles=[2];this.color=[Ball.G]}});Game.addClass({name:"BPaint",parent:"Paint",eventCreate:function(){this.callParent("eventCreate");this.sprite.tiles=[3];this.color=[Ball.B]}}); Game.addClass({name:"YPaint",parent:"Paint",eventCreate:function(){this.callParent("eventCreate");this.sprite.tiles=[4];this.color=[Ball.R,Ball.G]}});Game.addClass({name:"MPaint",parent:"Paint",eventCreate:function(){this.callParent("eventCreate");this.sprite.tiles=[6];this.color=[Ball.R,Ball.B]}});Game.addClass({name:"CPaint",parent:"Paint",eventCreate:function(){this.callParent("eventCreate");this.sprite.tiles=[7];this.color=[Ball.G,Ball.B]}}); Game.addClass({name:"WPaint",parent:"Paint",eventCreate:function(){this.callParent("eventCreate");this.sprite.tiles=[8];this.color=[Ball.R,Ball.G,Ball.B]}}); Game.addClass({name:"Absorber","abstract":!0,eventCreate:function(){this.sprite=new Sprite(Game.getImage("absorber"));this.sprite.makeTiles(32,64,1);this.sprite.imagespeed=0.3;this.collideSolid=!1;this.activated=!0;this.tempTiles=[];this.color=[];this.setZIndex(100);for(var a=1;22>=a;a++)this.sprite.setMask(a,{x:2,y:4,width:26,height:28})},switchState:function(){this.activated=!this.activated;this.sprite.tiles=this.activated?this.tiles:[1]},eventCollisionWith:function(a){this.activated&&a.instanceOf(Ball)&& a.perdCouleur(this.color)},eventOutsideView:function(){this.setActive(!1)},eventInsideView:function(){this.setActive(!0)}});Game.addClass({name:"RAbsorber",parent:"Absorber",eventCreate:function(){this.callParent("eventCreate");this.sprite.tiles=[2,3,4];this.tiles=[2,3,4];this.color=[Ball.R]}});Game.addClass({name:"GAbsorber",parent:"Absorber",eventCreate:function(){this.callParent("eventCreate");this.sprite.tiles=[5,6,7];this.tiles=[5,6,7];this.color=[Ball.G]}}); Game.addClass({name:"BAbsorber",parent:"Absorber",eventCreate:function(){this.callParent("eventCreate");this.sprite.tiles=[8,9,10];this.tiles=[8,9,10];this.color=[Ball.B]}});Game.addClass({name:"YAbsorber",parent:"Absorber",eventCreate:function(){this.callParent("eventCreate");this.sprite.tiles=[11,12,13];this.tiles=[11,12,13];this.color=[Ball.R,Ball.G]}}); Game.addClass({name:"MAbsorber",parent:"Absorber",eventCreate:function(){this.callParent("eventCreate");this.sprite.tiles=[14,15,16];this.tiles=[14,15,16];this.color=[Ball.R,Ball.B]}});Game.addClass({name:"CAbsorber",parent:"Absorber",eventCreate:function(){this.callParent("eventCreate");this.sprite.tiles=[17,18,19];this.tiles=[17,18,19];this.color=[Ball.G,Ball.B]}}); Game.addClass({name:"WAbsorber",parent:"Absorber",eventCreate:function(){this.callParent("eventCreate");this.sprite.tiles=[20,21,22];this.tiles=[20,21,22];this.color=[Ball.R,Ball.G,Ball.B]}}); Game.addClass({name:"Solid",eventCreate:function(){this.sprite=new Sprite(Game.getImage("peinture"));this.sprite.makeTiles(32,32,1);this.sprite.tiles=[9];this.solid=!0;this.sprite.imagespeed=0;this.visible=!1;this.isEnabled=this.desactivable=!0},eventCollisionWith:function(a){a.instanceOf(Ball)&&a.y>=this.y+this.sprite.height&&(a.vspeed=1)},eventOutsideView:function(){0<=this.y&&this.desactivable&&this.setActive(!1)},eventInsideView:function(){this.setActive(!0)}}); Game.addClass({name:"ActivedSolid",parent:"Solid",eventCreate:function(){this.callParent("eventCreate",[],"Solid");this.desactivable=!1}}); Game.addClass({name:"BlocFull",parent:"Solid","abstract":!0,eventCreate:function(){this.desactivable=!0;this.sprite=new Sprite(Game.getImage("blocs"));this.sprite.makeTiles(39,39);this.solid=!0;this.colors=[];this.y-=7;this.setZIndex((this.x-this.y)/1E6+20);for(var a=1;56>=a;a++)this.sprite.setMask(a,{x:0,y:7,height:32,width:32})},enable:function(){this.sprite.tiles[0]-=28;this.checkForCollisions=this.isEnabled=!0},disable:function(){this.sprite.tiles[0]+=28;this.checkForCollisions=this.isEnabled= !1},eventStep:function(){var a=Game.ball.isColor(this.colors);if(a&&!this.solid){if(a=this.sprite.getMask(),Game.ball.x>=this.x+a.x+a.width||Game.ball.x+Game.ball.sprite.width<=this.x+a.x||Game.ball.y>=this.y+a.y+a.height||Game.ball.y+Game.ball.sprite.height<=this.y+a.y)this.enable(),this.solid=!0}else!a&&this.solid&&(this.disable(),this.solid=!1)}}); Game.addClass({name:"NBlocFull",parent:"BlocFull",eventCreate:function(){this.callParent("eventCreate",[],BlocFull);this.colors=[Ball.VIDE,Ball.VIDE,Ball.VIDE];this.sprite.tiles=[8]}});Game.addClass({name:"RBlocFull",parent:"BlocFull",eventCreate:function(){this.callParent("eventCreate",[],BlocFull);this.colors=[Ball.PLEIN,Ball.VIDE,Ball.VIDE];this.sprite.tiles=[1]}}); Game.addClass({name:"GBlocFull",parent:"BlocFull",eventCreate:function(){this.callParent("eventCreate",[],BlocFull);this.colors=[Ball.VIDE,Ball.PLEIN,Ball.VIDE];this.sprite.tiles=[2]}});Game.addClass({name:"BBlocFull",parent:"BlocFull",eventCreate:function(){this.callParent("eventCreate",[],BlocFull);this.colors=[Ball.VIDE,Ball.VIDE,Ball.PLEIN];this.sprite.tiles=[3]}}); Game.addClass({name:"YBlocFull",parent:"BlocFull",eventCreate:function(){this.callParent("eventCreate",[],BlocFull);this.colors=[Ball.PLEIN,Ball.PLEIN,Ball.VIDE];this.sprite.tiles=[4]}});Game.addClass({name:"MBlocFull",parent:"BlocFull",eventCreate:function(){this.callParent("eventCreate",[],BlocFull);this.colors=[Ball.PLEIN,Ball.VIDE,Ball.PLEIN];this.sprite.tiles=[5]}}); Game.addClass({name:"CBlocFull",parent:"BlocFull",eventCreate:function(){this.callParent("eventCreate",[],BlocFull);this.colors=[Ball.VIDE,Ball.PLEIN,Ball.PLEIN];this.sprite.tiles=[6]}});Game.addClass({name:"WBlocFull",parent:"BlocFull",eventCreate:function(){this.callParent("eventCreate",[],BlocFull);this.colors=[Ball.PLEIN,Ball.PLEIN,Ball.PLEIN];this.sprite.tiles=[7]}}); Game.addClass({name:"BlocPart",parent:"BlocFull",eventStep:function(){var a=0,b;for(b in this.colors){if(this.colors[b]==Ball.PLEIN&&!Game.ball.hasColor(b))break;a++}if(a==this.colors.length){if(a=this.sprite.getMask(),Game.ball.x>=this.x+a.x+a.width||Game.ball.x+Game.ball.sprite.width<=this.x+a.x||Game.ball.y>=this.y+a.y+a.height||Game.ball.y+Game.ball.sprite.height<=this.y+a.y)this.solid||this.enable(),this.solid=!0}else this.solid&&this.disable(),this.solid=!1}}); Game.addClass({name:"RBlocPart",parent:"BlocPart",eventCreate:function(){this.callParent("eventCreate",[],BlocPart);this.colors=[Ball.PLEIN,Ball.VIDE,Ball.VIDE];this.sprite.tiles=[9]}});Game.addClass({name:"GBlocPart",parent:"BlocPart",eventCreate:function(){this.callParent("eventCreate",[],BlocPart);this.colors=[Ball.VIDE,Ball.PLEIN,Ball.VIDE];this.sprite.tiles=[10]}}); Game.addClass({name:"BBlocPart",parent:"BlocPart",eventCreate:function(){this.callParent("eventCreate",[],BlocPart);this.colors=[Ball.VIDE,Ball.VIDE,Ball.PLEIN];this.sprite.tiles=[11]}});Game.addClass({name:"YBlocPart",parent:"BlocPart",eventCreate:function(){this.callParent("eventCreate",[],BlocPart);this.colors=[Ball.PLEIN,Ball.PLEIN,Ball.VIDE];this.sprite.tiles=[12]}}); Game.addClass({name:"MBlocPart",parent:"BlocPart",eventCreate:function(){this.callParent("eventCreate",[],BlocPart);this.colors=[Ball.PLEIN,Ball.VIDE,Ball.PLEIN];this.sprite.tiles=[13]}});Game.addClass({name:"CBlocPart",parent:"BlocPart",eventCreate:function(){this.callParent("eventCreate",[],BlocPart);this.colors=[Ball.VIDE,Ball.PLEIN,Ball.PLEIN];this.sprite.tiles=[14]}}); Game.addClass({name:"BlocMovable","abstract":!0,eventCollisionWith:function(a){if(a.instanceOf(Ball))if(this.solid&&0==this.vspeed&&0==a.vspeed&&0!=a.hspeed){for(var b=Game.getInstancesByType(BlocMovable),c=0,d=b.length;c<d;c++)b[c].hspeed=0;this.hspeed=a.hspeed/2}else this.hspeed=0;else a.instanceOf(Solid)&&0<this.vspeed&&a.isEnabled&&(this.gravity=this.vspeed=0,this.y=a.y-32,this.sprite.width=0==this.vspeed&&Game.getInstancesIn(this.x+32,this.y+16,1,1,{elements:[this],types:[Paint,Absorber,Ball, Splash,Bubble,BlocFull,BlocPart]},!0)?30:39)},eventStep:function(){this.instanceOf(BlocPart)?this.callParent("eventStep",[],BlocPart):this.callParent("eventStep",[],BlocFull);if(0!=this.hspeed||0!=this.vspeed)this.x=Math.max(0,Math.min(this.x,Game.room.width-this.sprite.width)),this.y=Math.min(this.y,Game.room.height-this.sprite.height)},eventEndStep:function(){this.vspeed=Math.min(this.vspeed,10);var a=Game.getInstancesIn(this.x,this.y+this.sprite.height,32,1,{elements:[this],types:[Ball]}),b=0== a.length;if(!b)for(var b=!0,c=0,d=a.length;c<d;c++)if(a[c].isEnabled){b=!1;break}if(b)this.gravity=2,this.hspeed=0;else{this.gravity=this.vspeed=0;a=Game.getInstancesIn(this.x,this.y+48,32,1,{elements:[this]});c=0;for(d=a.length;c<d;c++)a[c].desactivable=!1}this.setZIndex((this.x-this.y)/1E6+20)},eventKeyDown:function(a){if(a==Game.KEY_UP||a==Game.KEY_LEFT&&0<this.hspeed||a==Game.KEY_RIGHT&&0>this.hspeed)return this.hspeed=0,!1},eventKeyUp:function(a){if((a==Game.KEY_LEFT||a==Game.KEY_RIGHT)&&0!= this.hspeed)return this.hspeed=0,!1},eventOutsideView:function(){this.setActive(!1)},eventInsideView:function(){this.setActive(!0)}});Game.addClass({name:"NBlocFullMovable",parent:["NBlocFull","BlocMovable"],eventCreate:function(){this.callParent("eventCreate",[],NBlocFull);this.sprite.tiles=[22]}});Game.addClass({name:"RBlocFullMovable",parent:["RBlocFull","BlocMovable"],eventCreate:function(){this.callParent("eventCreate",[],RBlocFull);this.sprite.tiles=[15]}}); Game.addClass({name:"GBlocFullMovable",parent:["GBlocFull","BlocMovable"],eventCreate:function(){this.callParent("eventCreate",[],GBlocFull);this.sprite.tiles=[16]}});Game.addClass({name:"BBlocFullMovable",parent:["BBlocFull","BlocMovable"],eventCreate:function(){this.callParent("eventCreate",[],BBlocFull);this.sprite.tiles=[17]}});Game.addClass({name:"YBlocFullMovable",parent:["YBlocFull","BlocMovable"],eventCreate:function(){this.callParent("eventCreate",[],YBlocFull);this.sprite.tiles=[18]}}); Game.addClass({name:"MBlocFullMovable",parent:["MBlocFull","BlocMovable"],eventCreate:function(){this.callParent("eventCreate",[],MBlocFull);this.sprite.tiles=[19]}});Game.addClass({name:"CBlocFullMovable",parent:["CBlocFull","BlocMovable"],eventCreate:function(){this.callParent("eventCreate",[],CBlocFull);this.sprite.tiles=[20]}});Game.addClass({name:"WBlocFullMovable",parent:["WBlocFull","BlocMovable"],eventCreate:function(){this.callParent("eventCreate",[],WBlocFull);this.sprite.tiles=[21]}}); Game.addClass({name:"RBlocPartMovable",parent:["RBlocPart","BlocMovable"],eventCreate:function(){this.callParent("eventCreate",[],RBlocPart);this.sprite.tiles=[23]}});Game.addClass({name:"GBlocPartMovable",parent:["GBlocPart","BlocMovable"],eventCreate:function(){this.callParent("eventCreate",[],GBlocPart);this.sprite.tiles=[24]}});Game.addClass({name:"BBlocPartMovable",parent:["BBlocPart","BlocMovable"],eventCreate:function(){this.callParent("eventCreate",[],BBlocPart);this.sprite.tiles=[25]}}); Game.addClass({name:"YBlocPartMovable",parent:["YBlocPart","BlocMovable"],eventCreate:function(){this.callParent("eventCreate",[],YBlocPart);this.sprite.tiles=[26]}});Game.addClass({name:"MBlocPartMovable",parent:["MBlocPart","BlocMovable"],eventCreate:function(){this.callParent("eventCreate",[],MBlocPart);this.sprite.tiles=[27]}});Game.addClass({name:"CBlocPartMovable",parent:["CBlocPart","BlocMovable"],eventCreate:function(){this.callParent("eventCreate",[],CBlocPart);this.sprite.tiles=[28]}}); Game.addClass({name:"End",eventCreate:function(){this.sprite=new Sprite(Game.getImage("end"));this.sprite.makeTiles(32,32);this.sprite.tiles=[1,2,3,4,5,6,7,8,9,10];this.collideSolid=!1;this.sprite.imagespeed=0.4;this.setZIndex(150)},eventCollisionWith:function(a){a.instanceOf(Ball)&&!a.endLevel&&(a.endLevel=!0,a.gravity=0,Game.soundsActivated?Game.soundIsPlaying("end")||(a.hspeed=0,a.vspeed=0,Game.playSound("end",!1,function(){Game.goToNextRoom();window.localStorage.getItem("RGB.lastLevel")<Game.room.id&& window.localStorage.setItem("RGB.lastLevel",Game.room.id)})):(a.hspeed=0,a.vspeed=0,setTimeout(function(){Game.goToNextRoom()},1E3)))}});Game.addClass({name:"Splash",eventCreate:function(){this.sprite=new Sprite(Game.getImage("splash"));this.sprite.makeTiles(69,68,1);this.sprite.imagespeed=0.6;this.setZIndex(600)},eventStep:function(){this.x=this.ball.x-18.5;this.y=this.ball.y-18},eventEndAnimation:function(){Game.instanceDestroy(this)}}); Game.addClass({name:"Bubble",eventCreate:function(){this.sprite=new Sprite(Game.getImage("bubbles"));this.sprite.makeTiles(32,28);this.sprite.tiles=[1,2,3,4];this.sprite.imagespeed=0.5;this.setZIndex(600);this.vspeed=-4},eventStep:function(){this.x=this.ball.x},eventEndAnimation:function(){Game.instanceDestroy(this)}}); Game.addClass({name:"Button",eventCreate:function(){this.sprite=new Sprite(Game.getImage("blocs"));this.sprite.makeTiles(39,39);this.sprite.tiles=[57];this.y-=7;this.sprite.imagespeed=0;this.setZIndex(10);this.activated=!1;this.solid=!0;this.sprite.setMask(57,{x:0,y:14,height:26,width:32});this.sprite.setMask(58,{x:0,y:27,height:16,width:32})},effect:function(){for(var a=Game.getInstancesByType(Absorber,!0),b=0,c=a.length;b<c;b++)a[b].switchState()},eventStep:function(){if(!this.activated)for(var a= Game.getInstancesIn(this.x,this.y-7,this.sprite.width-10,this.sprite.height,{elements:[this]}),b=0,c=a.length;b<c;b++)if(0<=a[b].vspeed&&(a[b].instanceOf(Ball)||a[b].instanceOf(BlocMovable))){this.activated=!0;this.sprite.tiles=[58];this.effect();break}},eventOutsideView:function(){this.setActive(!1)},eventInsideView:function(){this.setActive(!0)}}); Game.addClass({name:"Message",eventCreate:function(){this.sprite=new Sprite(Game.getImage("peinture"));this.sprite.makeTiles(32,32,1);this.sprite.tiles=[9];this.collideSolid=!1;this.setZIndex(100);switch(Game.room.id){case 1:this.message=Message.texts.INTRO.fr;break;case 2:this.message=Message.texts.MIX.fr;break;case 3:this.message=Message.texts.RESTART.fr;break;case 6:this.message=Message.texts.PART.fr;break;case 9:this.message=Message.texts.ABSORB.fr;break;case 10:this.message=Message.texts.ABSORB_COLORS.fr; break;case 20:this.message=Message.texts.MOVABLE.fr;break;case 26:this.message=Message.texts.BUTTON.fr;break;case 27:this.message=Message.texts.BUTTON_BIS.fr}},eventCollisionWith:function(a){if(a.instanceOf(Ball)){var b={x:3,y:3,maxWidth:Game.room.view_w,text:this.message},c=22*(Game.numberOfLines(b)+1);a.y<c&&(b.y+=Game.room.height-c);a.drawRectangle({x:0,y:a.y>=c?0:Game.room.height-c,width:Game.room.view_w,height:c,color:"#fff",opacity:70,borderLength:2,borderColor:"#444"});a.drawText(b)}}}); Message.texts={INTRO:{fr:"Bienvenue dans le jeu RGB ! Ici, les blocs se mat\u00e9rialisent selon la couleur de votre balle. Essayez de devenir rouge en touchant le pot de peinture !"},MIX:{fr:"En touchant un pot de peinture lorsque vous \u00eates d\u00e9j\u00e0 color\u00e9, un m\u00e9lange s'effectue ! N'oubliez pas que ce sont les normes RGB qui sont utilis\u00e9es !"},RESTART:{fr:'Si vous vous retrouvez coinc\u00e9, appuyez sur "R" pour recommencer le niveau en cours.'},PART:{fr:"Les blocs avec un point color\u00e9 restent solides tant que vous poss\u00e9dez la couleur qu'ils indiquent !"}, ABSORB:{fr:"Les absorbeurs aspirent les couleurs qui vous composent..."},ABSORB_COLORS:{fr:"Les absorbeurs color\u00e9s n'aspirent que leur couleur. Ainsi, l'absorbeur rouge n'aspire que le rouge !"},MOVABLE:{fr:"Les blocs avec une main peuvent \u00eatre pouss\u00e9s s'ils sont solides. Attention, ils sont \u00e9galement soumis \u00e0 la gravit\u00e9 !"},BUTTON:{fr:"Cet absorbeur est d\u00e9sactiv\u00e9 ! Appuyez sur le bouton pour le remettre en marche !"},BUTTON_BIS:{fr:"Une fois press\u00e9, un bouton active les absorbeurs d\u00e9sactiv\u00e9s et d\u00e9sactivent ceux activ\u00e9s..."}}; Game.addClass({name:"SelectLevel",drawLevel:function(){for(var a=this.level.toString(),b=a.length,c=59*b/2,d=0,e=0;e<b;e++){var d=parseInt(a[e],10),f=new Sprite(Game.getImage("chiffres"));f.makeTiles(59,91);f.tiles=[0==d?10:d];this.drawSprite({sprite:f,x:Game.room.width/2-c,y:140});c-=59}},eventCreate:function(){document.getElementById("taches").style.display="none";this.sprite=new Sprite(Game.getImage("logo"));this.hspeed=0.5;this.level=window.localStorage.getItem("RGB.lastLevel");this.level||(this.level= 1);this.max=this.level;this.press=!1},eventStep:function(){if(this.x>=this.xstart+6&&0<this.hspeed||this.x<=this.xstart-6&&0>this.hspeed)this.hspeed*=-1;this.drawLevel()},eventKeyPressed:function(a){switch(a){case Game.KEY_RIGHT:case Game.KEY_UP:if(!this.press){this.press=!0;var b=this;setTimeout(function(){b.press=!1},250);this.level++;this.level=this.level>this.max?1:this.level}return!1;case Game.KEY_LEFT:case Game.KEY_DOWN:return this.press||(this.press=!0,b=this,setTimeout(function(){b.press= !1},250),this.level--,this.level=1>this.level?this.max:this.level),!1}},eventKeyDown:function(a){switch(a){case Game.KEY_CONTROL:Game.toggleSounds();case Game.KEY_RIGHT:case Game.KEY_UP:case Game.KEY_LEFT:case Game.KEY_DOWN:return!1;case Game.KEY_ENTER:return document.getElementById("taches").style.display="block",Game.goToRoom(this.level),!1}}});Game.totalLevels=28;r=[new Room(288,296,"background")];for(var i=1;i<=Game.totalLevels;i++)r.push(new Room("./levels/"+i+".xml")); for(var i=1,l=r.length;i<l;i++)r[i].setView(288,256);r[0].eventStart=function(){1<window.localStorage.getItem("RGB.lastLevel")?(Game.titleLevel.innerHTML="Selection du niveau",Game.instanceCreate(5,5,SelectLevel)):(document.getElementById("taches").style.display="block",Game.goToNextRoom())};r[26].eventStart=function(){Game.getInstancesByType(Absorber,!0)[0].switchState()}; r[27].eventStart=function(){for(var a=Game.getInstancesByType(Absorber,!0),b=0,c=a.length;b<c;b++)a[b].instanceOf(YAbsorber)&&a[b].switchState()};r[28].eventStart=function(){for(var a=Game.getInstancesByType(Absorber,!0),b=Game.getInstancesByType(Button,!0),c=Game.getInstancesByType(BlocMovable,!0),d=0,e=a.length;d<e;d++)a[d].instanceOf(GAbsorber)&&a[d].switchState();d=0;for(e=c.length;d<e;d++)c[d].eventOutsideView=function(){};b[0].eventOutsideView=function(){}};Game.setRooms(r); Game.titleLevel=document.getElementById("level");Game.credits=document.getElementById("credits"); Game.gameStart=function(){var a=document.createElement("div"),b=document.getElementById("infoGameBuilder");Game.borders=document.getElementById("borders");a.style.cssText=b.style.cssText;a.style.height="40px";a.style.border="3px solid #000";a.style.color="#222";a.style.borderTop="0px";a.style.display="none";a.id="taches";a.style.backgroundImage='url("./images/backgroundColors.png")';Game.canvas.parentNode.insertBefore(a,b);a.innerHTML='<div id="red" class="tache">&Chi;</div><div class="tache none">+</div><div id="green" class="tache">&Chi;</div><div class="tache none">+</div><div id="blue" class="tache">&Chi;</div><div class="tache none">=</div><div id="color" class="tache"></div>'; Game.borders.style.backgroundImage="url('./images/webBackground.png')";Game.borders.style.border="3px solid #000";Game.borders.style.width="350px";Game.borders.style.height="350px";Game.red=document.getElementById("red");Game.green=document.getElementById("green");Game.blue=document.getElementById("blue");Game.color=document.getElementById("color");Game.playSound("music",!0)}; Game.loadAndRun("jeu",{background:"./images/background.png",logo:"./images/logo.png",chiffres:"./images/chiffres.png",peinture:"./images/paint.png",absorber:"./images/absorber.png",tiles:"./images/tiles.png",yeux:"./images/yeux.png",blocs:"./images/blocs.png",end:"./images/end.png",splash:"./images/splash.png",bubbles:"./images/bubbles.png"},{music:["./sounds/music.mp3","./sounds/music.ogg"],absorb:["./sounds/absorb.mp3","./sounds/absorb.ogg"],splash:["./sounds/splash.mp3","./sounds/splash.ogg"], end:["./sounds/end.mp3","./sounds/end.ogg"],jump:["./sounds/jump.mp3","./sounds/jump.ogg"]});