!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.JSGLib=e():t.JSGLib=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=139)}([function(t,e){var n=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(t,e,n){var i=n(40)("wks"),r=n(26),o=n(4).Symbol,s="function"==typeof o,a=t.exports=function(t){return i[t]||(i[t]=s&&o[t]||(s?o:r)("Symbol."+t))};a.store=i},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(87),o=i(r);e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,o.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}()},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){var i=n(14);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){t.exports=!n(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(4),r=n(0),o=n(17),s=n(11),a="prototype",u=function(t,e,n){var c,l,h,f=t&u.F,p=t&u.G,d=t&u.S,v=t&u.P,y=t&u.B,_=t&u.W,m=p?r:r[e]||(r[e]={}),g=m[a],w=p?i:d?i[e]:(i[e]||{})[a];p&&(n=e);for(c in n)l=!f&&w&&void 0!==w[c],l&&c in m||(h=l?w[c]:n[c],m[c]=p&&"function"!=typeof w[c]?n[c]:y&&l?o(h,i):_&&w[c]==h?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e[a]=t[a],e}(h):v&&"function"==typeof h?o(Function.call,h):h,v&&((m.virtual||(m.virtual={}))[c]=h,t&u.R&&g&&!g[c]&&s(g,c,h)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e,n){var i=n(5),r=n(60),o=n(42),s=Object.defineProperty;e.f=n(6)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){"use strict";function i(t){t.$events_callbacks||(t.$events_callbacks={})}var r=n(2),o=n.n(r),s=n(3),a=n.n(s),u=n(20),c=function(){function t(e){o()(this,t),this.defaultPrevented=!1,this.propagationStopped=!1,this.detail=e}return a()(t,[{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),t}(),l=n.i(u.a)({on:function(t,e){return i(this),this.$events_callbacks[t]||(this.$events_callbacks[t]=[]),this.$events_callbacks[t].push(e),this},off:function(t,e){var n=this;if(i(this),!t){for(var r in this.$events_callbacks)this.off(r);return this}return this.$events_callbacks[t]?e?(this.$events_callbacks[t].some(function(i,r){if(e===i)return n.$events_callbacks[t].splice(r,1),!0}),this.$events_callbacks[t].length||delete this.$events_callbacks[t],this):(delete this.$events_callbacks[t],this):this},trigger:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this);var n=new c(e);return this.$events_callbacks[t]?(this.$events_callbacks[t].some(function(t){return t(n),n.propagationStopped}),n):n}});e.a=l},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(8),r=n(24);t.exports=n(6)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(109),r=n(34);t.exports=function(t){return i(r(t))}},function(t,e,n){"use strict";var i=n(2),r=n.n(i),o=n(3),s=n.n(o),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;r()(this,t),this.x=e,this.y=n,this.x_min=NaN,this.y_min=NaN,this.x_max=NaN,this.y_max=NaN}return s()(t,[{key:"set",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this.x=t,this.y=e,isNaN(this.x_min)||(this.x=Math.max(this.x,this.x_min)),isNaN(this.x_max)||(this.x=Math.min(this.x,this.x_max)),isNaN(this.y_min)||(this.y=Math.max(this.y,this.y_min)),isNaN(this.y_max)||(this.y=Math.min(this.y,this.y_max)),this}},{key:"$set",value:function(t,e,n){return n?this.clone().set(t,e):this.set(t,e)}},{key:"copy",value:function(t){return this.set(t.x,t.y)}},{key:"clone",value:function(){return new t(this.x,this.y).minimum(this.x_min,this.y_min,!1).maximum(this.x_max,this.y_max,!1)}},{key:"equals",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.x+t.x,i=this.y+t.y;return this.$set(n,i,e)}},{key:"subtract",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.x-t.x,i=this.y-t.y;return this.$set(n,i,e)}},{key:"multiply",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.x*t.x,i=this.y*t.y;return this.$set(n,i,e)}},{key:"divide",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.x/t.x,i=this.y/t.y;return this.$set(n,i,e)}},{key:"abs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=Math.abs(this.x),n=Math.abs(this.y);return this.$set(e,n,t)}},{key:"round",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.x+(this.x<0?-.5:.5),n=this.y+(this.y<0?-.5:.5);return this.$set(0|e,0|n,t)}},{key:"minimum",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=n?this.clone():this;return i.x_min=t,i.y_min=e,this.set(this.x,this.y)}},{key:"maximum",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=n?this.clone():this;return i.x_max=t,i.y_max=e,this.set(this.x,this.y)}},{key:"isInRectangle",value:function(t){return this.x>=t.position.x&&this.x<t.position.x+t.width&&this.y>=t.position.y&&this.y<t.position.y+t.height}},{key:"isOverElement",value:function(t){return this.isInRectangle(t.getRectangle())}},{key:"getDistanceFromPoint",value:function(t){var e=this.subtract(t,!0).abs();return e.multiply(e),Math.sqrt(e.x+e.y)}}]),t}();e.a=a},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){t.exports={}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var i=n(32);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){"use strict";var i=n(2),r=n.n(i),o=n(3),s=n.n(o),a=n(13),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments[2];r()(this,t),this.width=e,this.height=n,this.position=i?i.clone():new a.a}return s()(t,[{key:"clone",value:function(){return new t(this.width,this.height,this.position)}},{key:"getCenter",value:function(){return new a.a(this.position.x+this.width/2,this.position.y+this.height/2)}},{key:"getSize",value:function(){var t=this.width,e=this.height;return{width:t,height:e}}},{key:"isCollidedWithRectangle",value:function(t){return!(t.position.x>=this.position.x+this.width||t.position.x+t.width<=this.position.x||t.position.y>=this.position.y+this.height||t.position.y+t.height<=this.position.y)}},{key:"containsRectangle",value:function(t){return t.position.x>this.position.x&&t.position.y>this.position.y&&t.position.x+t.width<this.position.x+this.width&&t.position.y+t.height<this.position.y+this.height}}]),t}();e.a=u},function(t,e,n){"use strict";function i(t){return function(e){o()(t).forEach(function(n){e.prototype[n]=t[n]})}}var r=n(30),o=n.n(r);e.a=i},function(t,e,n){t.exports={default:n(101),__esModule:!0}},function(t,e){t.exports=!0},function(t,e,n){var i=n(67),r=n(36);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var i=n(8).f,r=n(10),o=n(1)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e,n){"use strict";var i=n(125)(!0);n(61)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){n(129);for(var i=n(4),r=n(11),o=n(15),s=n(1)("toStringTag"),a=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],u=0;u<5;u++){var c=a[u],l=i[c],h=l&&l.prototype;h&&!h[s]&&r(h,s,c),o[c]=o.Array}},function(t,e,n){"use strict";var i=n(85),r=n.n(i),o=n(2),s=n.n(o),a=n(3),u=n.n(a),c=n(9),l=n(13),h=n(19),f=n(49),p=n(52),d=function(){function t(e,n){s()(this,t),this.prev_position=new l.a(NaN,NaN),this.position=new l.a(e,n),this.transform_origin=new l.a,this.rotation=0,this.layer=null,this.sprite_class=null,this.current_tile=null,this.current_animation=null,this.speed=new l.a,this.acceleration=new l.a,this.is_destroyed=!1,this.is_inside_room=!1,this.is_solid=!1,this.stop_on_solids=!1}return u()(t,[{key:"destroy",value:function(){var t=this.trigger("destroy");return t.defaultPrevented?this:(this.current_animation&&(this.current_animation.stop(),this.current_animation=null),this.is_destroyed=!0,this)}},{key:"setSpriteClass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.sprite_class=t,this.current_tile=t.getTile(e),this}},{key:"setCurrentTileNumber",value:function(t){return this.current_tile=this.sprite_class.getTile(t),this.layer&&(this.layer.needs_clear=!0),this}},{key:"useAnimation",value:function(t,e){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.current_animation&&this.current_animation.is_running){if(this.getAnimationName()===t)return this;this.current_animation.stop()}var o=this.sprite_class.getAnimationClass(t);if(!o)throw new ReferenceError('Element.useAnimation: animation "'+t+'" is not defined for sprite "'+this.sprite_class.name+'".');return this.current_animation=new o(r),this.setCurrentTileNumber(this.current_animation.getCurrentTileNumber()),this.current_animation.on("animation_update",function(){n.setCurrentTileNumber(n.current_animation.getCurrentTileNumber())}).start(e,i),this}},{key:"getAnimationName",value:function(){return this.current_animation?this.current_animation.name:""}},{key:"getSize",value:function(){var t=this.getRectangle(),e=t.width,n=t.height;return{width:e,height:n}}},{key:"getDirection",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=Math.atan2(-this.speed.y,this.speed.x);return t?n.i(p.a)(e):e}},{key:"draw",value:function(t){var e=this.position.add(this.transform_origin,!0),i=this.position.subtract(e,!0);return t.save(),t.translate(e.x,e.y),t.rotate(n.i(p.b)(this.rotation)),this.current_tile.draw(t,i.x,i.y),t.restore(),this}},{key:"getRectangle",value:function(){var t=this.sprite_class?this.sprite_class.getTilesSize():{};return new h.a(t.width,t.height,this.position)}},{key:"setTransformOriginToCenter",value:function(){var t=this.getSize(),e=t.width,n=t.height;return this.transform_origin.set(e/2,n/2),this}},{key:"move",value:function(t){var e=new l.a(t,t);return this.speed.add(this.acceleration),this.position.add(this.speed.multiply(e,!0)),this}},{key:"getCurrentMasks",value:function(){return this.current_tile.hasMasks()?this.current_tile.masks:[f.a.createFromRectangle(this.getRectangle(),this.is_solid,this.stop_on_solids)]}},{key:"checkCollisions",value:function(t){var e=this,n=!1,i=[],r=[],o=[];if(this.getCurrentMasks().forEach(function(s){for(var a in t){var u=t[a],c=e.checkTilesCollisions(u,s);if(s.stop_on_solids&&c.solids_collisions){n=!0;var l=c.tiles.filter(function(t){return t.tile.isSolid()});l=l.map(function(t){return{mask:s,solid_tile_data:t}}),i=i.concat(l),e.refinePosition(u,s,e.checkTilesCollisions),c.slopes_collisions&&e.refinePositionOnSlopes(l.filter(function(t){return t.solid_tile_data.tile.isSlope()}))}c.tiles.some(function(t){var n=e.trigger("tile_collision",{tile_data:t,mask:s});return n.propagationStopped}),c=e.checkElementsCollisions(u,s),s.stop_on_solids&&c.solids_collisions&&(n=!0,c.collisions.forEach(function(t){t.element.is_solid&&r.push({mask:s,solid_element:t.element});var e=t.masks.filter(function(t){return t.is_solid});e=e.map(function(t){return{mask:s,solid_mask:t}}),o=o.concat(e)}),e.refinePosition(u,s,e.checkElementsCollisions)),c.collisions.some(function(t){var n=e.trigger("collision",{collision:t});return n.propagationStopped})}}),n){var s=r.map(function(t){return{mask:t.mask,solid:t.solid_element,position:t.solid_element.position}}),a=o.map(function(t){return{mask:t.mask,solid:t.solid_mask,position:t.solid_mask.position}}),u=i.map(function(t){return{mask:t.mask,solid:t.solid_tile_data.tile,position:t.solid_tile_data.position}}),c=u.concat(s).concat(a);this.trigger("solids_collision",{elements_collisions:s,masks_collisions:a,tiles_collisions:u,all_solids_collisions:c})}else this.trigger("no_solids_collision")}},{key:"checkTilesCollisions",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position,i={tiles:[],solids_collisions:!1,slopes_collisions:!1,only_slopes_collisions:!1};if(!t.tiles.length)return i;var r=e.clone();r.position.add(n),i.tiles=t.getTilesFromRectangle(r);var o=i.tiles.filter(function(t){return t.tile.isEndSlope()})[0];if(o){var s=o.tile.getContactY(r.getCenter().x,o.position);if(!isNaN(s)){var a=o.tile.getSize().width;0===o.tile.slope_point.x&&(a*=-1),i.tiles=i.tiles.filter(function(t){return!(t.tile.isSolid()&&t.position.y===o.position.y&&t.position.x===o.position.x+a)})}}var u=i.tiles.filter(function(t){return t.tile.isSolid()});return i.solids_collisions=u.length>0,i.slopes_collisions=i.solids_collisions&&u.some(function(t){return t.tile.isSlope()}),i.only_slopes_collisions=i.slopes_collisions&&u.every(function(t){return t.tile.isSlope()}),i}},{key:"checkElementsCollisions",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position,r={collisions:[],solids_collisions:!1};if(!t.elements.length)return r;var o=e.clone();return o.position.add(i),t.elements.forEach(function(t){if(t!==n){var e={element:null,masks:[]};t.getCurrentMasks().forEach(function(n){var i=n.clone();i.position.add(t.position),o.isCollidedWithRectangle(i)&&(e.element=t,e.masks.push(i))}),e.element&&r.collisions.push(e)}}),r.solids_collisions=r.collisions.some(function(t){return t.element.is_solid||t.masks.some(function(t){return t.is_solid})}),r}},{key:"refinePosition",value:function(t,e,n){for(var i=this.position.subtract(this.prev_position,!0),o=Math.abs(i.x),s=Math.abs(i.y),a=r()(i.x),u=r()(i.y),c=this.prev_position.clone(),l=0;l<o;l++){c.x+=a;var h=n.call(this,t,e,c);if(h.solids_collisions&&!h.only_slopes_collisions){c.x-=a;break}}for(var f=0;f<s;f++){c.y+=u;var p=n.call(this,t,e,c);if(p.solids_collisions&&!p.only_slopes_collisions){c.y-=u;break}}return this.position.copy(c),this}},{key:"refinePositionOnSlopes",value:function(t){var e=this,n=this.position.clone(),i=this.getSize().height,r=this.getRectangle().getCenter().x;return t.some(function(t){var o=t.solid_tile_data.tile.getContactY(r,t.solid_tile_data.position);return!isNaN(o)&&(n.y=o-i-1,n.y-e.position.y>=0||(e.position.copy(n).round(),!0))})}},{key:"onCollision",value:function(t,e){return this.on("collision",function(n){var i=n.detail.collision.element;i instanceof t&&e(n.detail.collision,n)}),this}}]),t}();n.i(c.a)(d),e.a=d},function(t,e,n){t.exports={default:n(96),__esModule:!0}},function(t,e,n){t.exports={default:n(100),__esModule:!0}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var i=n(16),r=n(1)("toStringTag"),o="Arguments"==i(function(){return arguments}()),s=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=s(e=Object(t),r))?n:o?i(e):"Object"==(a=i(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var i=n(14),r=n(4).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var i=n(5),r=n(120),o=n(36),s=n(39)("IE_PROTO"),a=function(){},u="prototype",c=function(){var t,e=n(35)("iframe"),i=o.length,r="<",s=">";for(e.style.display="none",n(59).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(r+"script"+s+"document.F=Object"+r+"/script"+s),t.close(),c=t.F;i--;)delete c[u][o[i]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(a[u]=i(t),n=new a,a[u]=null,n[s]=t):n=c(),void 0===e?n:r(n,e)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var i=n(40)("keys"),r=n(26);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e,n){var i=n(4),r="__core-js_shared__",o=i[r]||(i[r]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){var i=n(14);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(4),r=n(0),o=n(22),s=n(44),a=n(8).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=o?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},function(t,e,n){e.f=n(1)},function(t,e,n){"use strict";var i=n(55),r=n.n(i),o=n(57),s=n.n(o),a=n(56),u=n.n(a),c=n(21),l=n.n(c),h=n(2),f=n.n(h),p=n(3),d=n.n(p),v=n(53),y=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;f()(this,t),this.timer=e,this.tiles_numbers=n,this.default_time=i,this.animation_index=0,this.animation_clock=null,this.is_running=!1}return d()(t,[{key:"getPreviousTileNumber",value:function(){var t=this.animation_index>0?this.animation_index-1:this.tiles_numbers.length-1;return this.tiles_numbers[t]}},{key:"getCurrentTileNumber",value:function(){return this.tiles_numbers[this.animation_index]}},{key:"start",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.default_time,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.is_running=!0,this.animation_clock=this.timer.setTimeout(function(){t.animation_index++,t.animation_index<t.tiles_numbers.length?(t.trigger("animation_update"),t.start(e,n)):n?(t.stop(),t.trigger("animation_update"),t.start(e,n)):(t.stop(),t.trigger("animation_end"))},e),this}},{key:"stop",value:function(){return this.animation_clock&&this.timer.clearTimeout(this.animation_clock),this.animation_clock=null,this.animation_index=0,this.is_running=!1,this}}],[{key:"define",value:function(e,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l()();return t.classes[o]=function(t){function a(t){f()(this,a);var u=s()(this,(a.__proto__||r()(a)).call(this,e||t,n,i));return u.name=o,u}return u()(a,t),a}(t),t.classes[o]}}]),t}();y.classes={},n.i(v.Events_Handler)(y),e.a=y},function(t,e,n){"use strict";function i(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")}function r(t,e,n,i){return function(){if(4===t.readyState)if(200===t.status||304===t.status){var r=void 0;switch(e){case d:r=JSON.parse(t.responseText);break;case v:r=t.responseXML;break;default:r=t.responseText}n(r)}else i(t)}}function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:p,a=function(a,u){var h=new XMLHttpRequest,f=null;n&&(f=i(n)),f&&t===c&&(e+=e.indexOf("?")===-1?"?":"&",e+=f),h.onreadystatechange=r(h,s,a,u),h.open(t,e,o),h.send(t===l?f:null)};return new u.a(a)}function s(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.data,r=void 0===i?void 0:i,s=n.async,a=void 0===s||s,u=n.data_type,c=void 0===u?p:u;return o(t,e,r,a,c)}}var a=n(31),u=n.n(a),c="GET",l="POST",h="PUT",f="DELETE",p="TEXT",d="JSON",v="XML",y={DATA_TYPES:{TEXT:p,XML:v,JSON:d},get:s(c),post:s(l),delete:s(f),put:s(h)};e.a=y},function(t,e,n){"use strict";var i=n(2),r=n.n(i),o=n(3),s=n.n(o),a=n(9),u=n(13),c=function(){function t(e){var n=this;r()(this,t),this.mouse=new u.a,this.keys_pressed=[],this.dom_element=e,this.$mouseMoveEventHandler=function(t){var e=n.dom_element,i=t.pageX,r=t.pageY;i-=e.getBoundingClientRect().left+(window.pageXOffset||e.scrollLeft)+(e.clientLeft||0),r-=e.getBoundingClientRect().top+(window.pageYOffset||e.scrollTop)+(e.clientTop||0),n.mouse.set(Math.floor(i),Math.floor(r)),n.trigger("mousemove",{mouse:n.mouse})},this.$clickHandler=function(){n.trigger("click",{mouse:n.mouse})},this.$keyDownHandler=function(e){var i=e.which||e.keyCode;if(!(n.isKeyPressed(i)||n.keys_pressed.length>=2)){n.keys_pressed.push(i);var r=n.trigger("keydown",{key:i,is_arrow:i>=t.KEYS.ARROWS.LEFT&&i<=t.KEYS.ARROWS.DOWN});r.defaultPrevented&&e.preventDefault()}},this.$keyUpHandler=function(e){var i=e.which||e.keyCode;n.keys_pressed.some(function(t,e){if(i===t)return n.keys_pressed.splice(e,1),!0});var r=n.trigger("keyup",{key:i,is_arrow:i>=t.KEYS.ARROWS.LEFT&&i<=t.KEYS.ARROWS.DOWN});r.defaultPrevented&&e.preventDefault()},this.$windowFocusHandler=function(){n.trigger("window_focus")},this.$windowBlurHandler=function(){n.trigger("window_blur")},e.addEventListener("mousemove",this.$mouseMoveEventHandler),e.addEventListener("click",this.$clickHandler),document.body.addEventListener("keydown",this.$keyDownHandler),document.body.addEventListener("keyup",this.$keyUpHandler),window.addEventListener("focus",this.$windowFocusHandler),window.addEventListener("blur",this.$windowBlurHandler)}return s()(t,[{key:"destroy",value:function(){return this.dom_element.removeEventListener("mousemove",this.$mouseMoveEventHandler),this.dom_element.removeEventListener("click",this.$clickHandler),document.body.removeEventListener("keydown",this.$keyDownHandler),document.body.removeEventListener("keyup",this.$keyUpHandler),window.removeEventListener("focus",this.$windowFocusHandler),window.removeEventListener("blur",this.$windowBlurHandler),this.off(),this.dom_element=null,this.mouse=null,this.keys_pressed=[],this}},{key:"isKeyPressed",value:function(t){return this.keys_pressed.indexOf(t)>=0}}]),t}();c.KEYS={ARROWS:{LEFT:37,UP:38,RIGHT:39,DOWN:40},TAB:9,ENTER:13,SHIFT:16,CTRL:17,CONTROL:17,ALT:18,CAPS_LOCK:20,SPACE:32,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90},n.i(a.a)(c),e.a=c},function(t,e,n){"use strict";var i=n(54),r=n.n(i),o=n(30),s=n.n(o),a=n(2),u=n.n(a),c=n(3),l=n.n(c),h=n(13),f=function(){function t(e){u()(this,t),this.name=e,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.ctx.imageSmoothingEnabled=!1,this.canvas.setAttribute("data-name",this.name),this.canvas.style.position="absolute",this.canvas.style.left=0,this.canvas.style.top=0,this.canvas.style.zIndex=0,this.tiles_sprite_class=null,this.needs_clear=!1,this.tiles=[],this.elements=[],this.tiles_animations=[]}return l()(t,[{key:"setSize",value:function(t,e){return this.canvas.width=t,this.canvas.height=e,this}},{key:"setZindex",value:function(t){return this.canvas.style.zIndex=t,this}},{key:"getTileFromPoint",value:function(t){if(!this.tiles_sprite_class)return null;var e=this.tiles_sprite_class.getTilesSize(),n=this.tiles[Math.floor(t.y/e.height)];return n?n[Math.floor(t.x/e.width)]||null:null}},{key:"getTilesFromRectangle",value:function(t){var e=[];if(!this.tiles_sprite_class)return e;for(var n=this.tiles_sprite_class.getTilesSize(),i=Math.floor(t.position.x/n.width),r=Math.floor(t.position.y/n.height),o=Math.floor((t.position.x+t.width-1)/n.width),s=Math.floor((t.position.y+t.height-1)/n.height),a=i;a<=o;a++)for(var u=r;u<=s;u++){var c=this.tiles[u];if(c){var l=c[a];l&&e.push({tile:l,position:new h.a(a*n.width,u*n.height)})}}return e}},{key:"getAllTilesFromNumber",value:function(t){var e=[];return this.tiles.forEach(function(n){n.forEach(function(n){n.tile_number===t&&e.push(n)})}),e}},{key:"addElement",value:function(t){return t.layer&&t.layer.removeElement(t),t.layer=this,this.elements.push(t),this.needs_clear=!0,this}},{key:"removeElement",value:function(t){var e=this;return this.elements.some(function(n,i){if(n===t)return e.elements.splice(i,1),t.layer=null,e.needs_clear=!0,!0}),this}},{key:"clearTilesAnimations",value:function(){return this.tiles_animations.forEach(function(t){t.stop()}),this.tiles_animations=[],this}},{key:"initTilesAnimations",value:function(t){var e=this;if(!this.tiles_sprite_class)throw new Error("Layer.initTilesAnimation: this layer has no Sprite class for its tiles.");var n=Array.prototype.concat(s()(this.tiles_sprite_class.animations),r()(this.tiles_sprite_class.animations));return n.forEach(function(n){var i=e.tiles_sprite_class.animations[n],r=new i(t);e.tiles_animations.push(r),r.on("animation_update",function(){e.getAllTilesFromNumber(r.getPreviousTileNumber()).forEach(function(t){t.setTileNumber(r.getCurrentTileNumber())})}).start()}),this}},{key:"draw",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.tiles.length?(this.tiles.forEach(function(n,i){n.forEach(function(n,r){if(e||n.needs_redraw){var o={width:n.sprite_class.tiles_width,height:n.sprite_class.tiles_height},s=r*o.width,a=i*o.height;n.needs_redraw=!1,n.clear(t.ctx,s,a),n.is_empty||n.draw(t.ctx,s,a)}})}),this):e?(this.elements.forEach(function(e){e.draw(t.ctx)}),this):this}},{key:"clear",value:function(){return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this}}]),t}();f.MAIN_LAYER=new f("MAIN_LAYER"),f.TILES_LAYER=new f("TILES_LAYER"),f.BACKGROUND_LAYER=new f("BACKGROUND_LAYER"),e.a=f},function(t,e,n){"use strict";var i=n(55),r=n.n(i),o=n(2),s=n.n(o),a=n(3),u=n.n(a),c=n(57),l=n.n(c),h=n(56),f=n.n(h),p=n(19),d=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];s()(this,e);var u=l()(this,(e.__proto__||r()(e)).call(this,t,n,i));return u.is_solid=o,u.stop_on_solids=a,u}return f()(e,t),u()(e,[{key:"clone",value:function(){return new e(this.width,this.height,this.position,this.is_solid,this.stop_on_solids)}}],[{key:"createFromRectangle",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new e(t.width,t.height,void 0,n,i)}}]),e}(p.a);e.a=d},function(t,e,n){"use strict";var i=n(21),r=n.n(i),o=n(2),s=n.n(o),a=n(3),u=n.n(a),c=n(13),l=n(9),h=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];s()(this,t),this.sprite_class=e,this.sheet_position=new c.a(n,i),this.tile_number=r,this.type=o,this.masks=a,this.is_empty=!1,this.needs_redraw=!0,this.slope_point=null}return u()(t,[{key:"getSize",value:function(){return this.sprite_class.getTilesSize()}},{key:"clone",value:function(){var e=new t(this.sprite_class,this.sheet_position.x,this.sheet_position.y,this.tile_number,this.type);return e.slope_point=this.slope_point?this.slope_point.clone():null,e.masks=this.masks.slice(0),e}},{key:"setTileNumber",value:function(t){var e=this.sprite_class.getTile(t);return this.is_empty=e.is_empty,this.tile_number=t,this.sheet_position=e.sheet_position,this.type=e.type,this.slope_point=e.slope_point?e.slope_point.clone():null,this.masks=e.masks.slice(0),this.needs_redraw=!0,this}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i={width:this.sprite_class.tiles_width,height:this.sprite_class.tiles_height};return t.drawImage(this.sprite_class.image,this.sheet_position.x,this.sheet_position.y,i.width,i.height,e,n,i.width,i.height),this.trigger("drawn"),this}},{key:"clear",value:function(t,e,n){var i={width:this.sprite_class.tiles_width,height:this.sprite_class.tiles_height};return t.clearRect(e,n,i.width,i.height),this}},{key:"hasMasks",value:function(){return this.masks.length>0}},{key:"isSolid",value:function(){return this.type===t.TYPES.SOLID||this.isSlope()}},{key:"isSlope",value:function(){return null!==this.slope_point}},{key:"isEndSlope",value:function(){return this.isSlope()&&(0===this.slope_point.x||0===this.slope_point.y)}},{key:"getContactY",value:function(t,e){var n=this.getXOnTile(t,e.x),i=this.getYFromSlope(n);return isNaN(i)?NaN:e.y+i}},{key:"getXOnTile",value:function(t,e){return(t-e)/this.getSize().width}},{key:"getYFromSlope",value:function(t){return this.isSlope()?t<0||t>1?NaN:(1-t)*this.slope_point.x+t*this.slope_point.y:0}}],[{key:"getNewEmptyTile",value:function(e){var n=new t(e);return n.is_empty=!0,n}}]),t}();h.TYPES={SOLID:r()(),SLOPE:r()()},n.i(l.a)(h),e.a=h},function(t,e,n){"use strict";var i=n(2),r=n.n(i),o=n(3),s=n.n(o),a=n(9),u=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;r()(this,t),this.fps=n,this.clocks={},this.on("frame",function(){e.checkCounters()})}return s()(t,[{key:"destroy",value:function(){return this.clocks={},this.off(),this}},{key:"checkCounters",value:function(){for(var t in this.clocks){var e=this.clocks[t];++e.counter>=e.target&&(this.trigger(t),this.clearTimeout(t))}return this}},{key:"setTimeout",value:function(t,e){var n=(Date.now()*Math.random()).toString(16);return this.clocks[n]={counter:0,target:e/1e3*this.fps},this.on(n,t),n}},{key:"clearTimeout",value:function(t){return delete this.clocks[t],this.off(t)}}]),t}();n.i(a.a)(u),e.a=u},function(t,e,n){"use strict";function i(t,e){if(t>e){var n=[e,t];t=n[0],e=n[1]}var i=1+e-t;return Math.floor(i*Math.random())+t;
}function r(t){for(var e=[],n=t.length;n;){var i=Math.floor(Math.random()*t.length),r=t.splice(i,1);n--,e.push(r[0])}return e}function o(t){return(360-t)*Math.PI/180}function s(t){for(var e=-t/(Math.PI/180)+360;e<0;)e+=360;return e%360}e.b=o,e.a=s;var a={random:i,shuffleArray:r,degreeToRadian:o};e.c=a},function(t,e,n){"use strict";var i=n(9),r=n(81),o=n(82);e.a={Events_Handler:i.a,Keys_Mapping:r.a,Move_Wrap:o.a}},function(t,e,n){t.exports={default:n(97),__esModule:!0}},function(t,e,n){t.exports={default:n(98),__esModule:!0}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(88),o=i(r),s=n(86),a=i(s),u=n(58),c=i(u);e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof e?"undefined":(0,c.default)(e)));t.prototype=(0,a.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(o.default?(0,o.default)(t,e):t.__proto__=e)}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(58),o=i(r);e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==("undefined"==typeof e?"undefined":(0,o.default)(e))&&"function"!=typeof e?t:e}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(89),o=i(r),s=n(21),a=i(s),u="function"==typeof a.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof a.default&&t.constructor===a.default&&t!==a.default.prototype?"symbol":typeof t};e.default="function"==typeof a.default&&"symbol"===u(o.default)?function(t){return"undefined"==typeof t?"undefined":u(t)}:function(t){return t&&"function"==typeof a.default&&t.constructor===a.default&&t!==a.default.prototype?"symbol":"undefined"==typeof t?"undefined":u(t)}},function(t,e,n){t.exports=n(4).document&&document.documentElement},function(t,e,n){t.exports=!n(6)&&!n(18)(function(){return 7!=Object.defineProperty(n(35)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){"use strict";var i=n(22),r=n(7),o=n(69),s=n(11),a=n(10),u=n(15),c=n(113),l=n(25),h=n(66),f=n(1)("iterator"),p=!([].keys&&"next"in[].keys()),d="@@iterator",v="keys",y="values",_=function(){return this};t.exports=function(t,e,n,m,g,w,k){c(n,e,m);var x,b,E,S=function(t){if(!p&&t in P)return P[t];switch(t){case v:return function(){return new n(this,t)};case y:return function(){return new n(this,t)}}return function(){return new n(this,t)}},T=e+" Iterator",O=g==y,M=!1,P=t.prototype,N=P[f]||P[d]||g&&P[g],A=N||S(g),R=g?O?S("entries"):A:void 0,j="Array"==e?P.entries||N:N;if(j&&(E=h(j.call(new t)),E!==Object.prototype&&(l(E,T,!0),i||a(E,f)||s(E,f,_))),O&&N&&N.name!==y&&(M=!0,A=function(){return N.call(this)}),i&&!k||!p&&!M&&P[f]||s(P,f,A),u[e]=A,u[T]=_,g)if(x={values:O?A:S(y),keys:w?A:S(v),entries:R},k)for(b in x)b in P||o(P,b,x[b]);else r(r.P+r.F*(p||M),e,x);return x}},function(t,e,n){var i=n(38),r=n(24),o=n(12),s=n(42),a=n(10),u=n(60),c=Object.getOwnPropertyDescriptor;e.f=n(6)?c:function(t,e){if(t=o(t),e=s(e,!0),u)try{return c(t,e)}catch(t){}if(a(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e,n){var i=n(12),r=n(64).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(t){try{return r(t)}catch(t){return s.slice()}};t.exports.f=function(t){return s&&"[object Window]"==o.call(t)?a(t):r(i(t))}},function(t,e,n){var i=n(67),r=n(36).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var i=n(10),r=n(72),o=n(39)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){var i=n(10),r=n(12),o=n(105)(!1),s=n(39)("IE_PROTO");t.exports=function(t,e){var n,a=r(t),u=0,c=[];for(n in a)n!=s&&i(a,n)&&c.push(n);for(;e.length>u;)i(a,n=e[u++])&&(~o(c,n)||c.push(n));return c}},function(t,e,n){var i=n(7),r=n(0),o=n(18);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],s={};s[t]=e(n),i(i.S+i.F*o(function(){n(1)}),"Object",s)}},function(t,e,n){t.exports=n(11)},function(t,e,n){var i,r,o,s=n(17),a=n(108),u=n(59),c=n(35),l=n(4),h=l.process,f=l.setImmediate,p=l.clearImmediate,d=l.MessageChannel,v=0,y={},_="onreadystatechange",m=function(){var t=+this;if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},g=function(t){m.call(t.data)};f&&p||(f=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return y[++v]=function(){a("function"==typeof t?t:Function(t),e)},i(v),v},p=function(t){delete y[t]},"process"==n(16)(h)?i=function(t){h.nextTick(s(m,t,1))}:d?(r=new d,o=r.port2,r.port1.onmessage=g,i=s(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(i=function(t){l.postMessage(t+"","*")},l.addEventListener("message",g,!1)):i=_ in c("script")?function(t){u.appendChild(c("script"))[_]=function(){u.removeChild(this),m.call(t)}}:function(t){setTimeout(s(m,t,1),0)}),t.exports={set:f,clear:p}},function(t,e,n){var i=n(41),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e,n){var i=n(34);t.exports=function(t){return Object(i(t))}},function(t,e,n){var i=n(33),r=n(1)("iterator"),o=n(15);t.exports=n(0).getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||o[i(t)]}},function(t,e){},function(t,e,n){"use strict";var i=n(4),r=n(10),o=n(6),s=n(7),a=n(69),u=n(118).KEY,c=n(18),l=n(40),h=n(25),f=n(26),p=n(1),d=n(44),v=n(43),y=n(116),_=n(106),m=n(111),g=n(5),w=n(12),k=n(42),x=n(24),b=n(37),E=n(63),S=n(62),T=n(8),O=n(23),M=S.f,P=T.f,N=E.f,A=i.Symbol,R=i.JSON,j=R&&R.stringify,C="prototype",L=p("_hidden"),$=p("toPrimitive"),F={}.propertyIsEnumerable,I=l("symbol-registry"),D=l("symbols"),Y=l("op-symbols"),H=Object[C],K="function"==typeof A,W=i.QObject,z=!W||!W[C]||!W[C].findChild,U=o&&c(function(){return 7!=b(P({},"a",{get:function(){return P(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=M(H,e);i&&delete H[e],P(t,e,n),i&&t!==H&&P(H,e,i)}:P,B=function(t){var e=D[t]=b(A[C]);return e._k=t,e},G=K&&"symbol"==typeof A.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof A},J=function(t,e,n){return t===H&&J(Y,e,n),g(t),e=k(e,!0),g(n),r(D,e)?(n.enumerable?(r(t,L)&&t[L][e]&&(t[L][e]=!1),n=b(n,{enumerable:x(0,!1)})):(r(t,L)||P(t,L,x(1,{})),t[L][e]=!0),U(t,e,n)):P(t,e,n)},X=function(t,e){g(t);for(var n,i=_(e=w(e)),r=0,o=i.length;o>r;)J(t,n=i[r++],e[n]);return t},q=function(t,e){return void 0===e?b(t):X(b(t),e)},Z=function(t){var e=F.call(this,t=k(t,!0));return!(this===H&&r(D,t)&&!r(Y,t))&&(!(e||!r(this,t)||!r(D,t)||r(this,L)&&this[L][t])||e)},Q=function(t,e){if(t=w(t),e=k(e,!0),t!==H||!r(D,e)||r(Y,e)){var n=M(t,e);return!n||!r(D,e)||r(t,L)&&t[L][e]||(n.enumerable=!0),n}},V=function(t){for(var e,n=N(w(t)),i=[],o=0;n.length>o;)r(D,e=n[o++])||e==L||e==u||i.push(e);return i},tt=function(t){for(var e,n=t===H,i=N(n?Y:w(t)),o=[],s=0;i.length>s;)!r(D,e=i[s++])||n&&!r(H,e)||o.push(D[e]);return o};K||(A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(n){this===H&&e.call(Y,n),r(this,L)&&r(this[L],t)&&(this[L][t]=!1),U(this,t,x(1,n))};return o&&z&&U(H,t,{configurable:!0,set:e}),B(t)},a(A[C],"toString",function(){return this._k}),S.f=Q,T.f=J,n(64).f=E.f=V,n(38).f=Z,n(65).f=tt,o&&!n(22)&&a(H,"propertyIsEnumerable",Z,!0),d.f=function(t){return B(p(t))}),s(s.G+s.W+s.F*!K,{Symbol:A});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)p(et[nt++]);for(var et=O(p.store),nt=0;et.length>nt;)v(et[nt++]);s(s.S+s.F*!K,"Symbol",{for:function(t){return r(I,t+="")?I[t]:I[t]=A(t)},keyFor:function(t){if(G(t))return y(I,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),s(s.S+s.F*!K,"Object",{create:q,defineProperty:J,defineProperties:X,getOwnPropertyDescriptor:Q,getOwnPropertyNames:V,getOwnPropertySymbols:tt}),R&&s(s.S+s.F*(!K||c(function(){var t=A();return"[null]"!=j([t])||"{}"!=j({a:t})||"{}"!=j(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!G(t)){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);return e=i[1],"function"==typeof e&&(n=e),!n&&m(e)||(e=function(t,e){if(n&&(e=n.call(this,t,e)),!G(e))return e}),i[1]=e,j.apply(R,i)}}}),A[C][$]||n(11)(A[C],$,A[C].valueOf),h(A,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(78),r=n(53);n.d(e,"Core",function(){return i.a}),n.d(e,"Traits",function(){return r.a})},function(t,e,n){"use strict";var i=n(2),r=n.n(i),o=n(3),s=n.n(o),a=n(48),u=n(51),c=n(47),l=n(9),h=function(){function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[a.a.MAIN_LAYER,a.a.TILES_LAYER,a.a.BACKGROUND_LAYER],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;r()(this,t),this.container=e,this.current_room=null,this.classes={},this.timer=new u.a(o),this.is_paused=!1,this.is_stopped=!1,this.defineLayers(i),this.inputs=new c.a(this.container),this.inputs.on("click",function(){for(var t in n.layers){var e=n.layers[t];e.elements.some(function(t){if(n.inputs.mouse.isOverElement(t)){var e=t.trigger("click",{mouse:n.inputs.mouse});return e.propagationStopped}})}}).on("window_blur",this.togglePause.bind(this,!0)).on("window_focus",this.togglePause.bind(this,!1)),this.on("pause_disabled",function(){n.last_loop_time=Date.now(),n.$launchLoop()})}return s()(t,[{key:"defineLayers",value:function(t){var e=this;return this.layers={},t.reverse().forEach(function(t,n){t.setZindex(n),e.layers[t.name]=t,e.container.appendChild(t.canvas)}),this}},{key:"getLayerFromName",value:function(t){return this.layers[t]}},{key:"registerClass",value:function(t){return this.classes[t.name]=t,this}},{key:"getClass",value:function(t){return"function"==typeof t?t:this.classes[t]?this.classes[t]:window[t]}},{key:"start",value:function(){return this.trigger("start"),this.last_loop_time=Date.now(),this.$loop(),this}},{key:"stop",value:function(){var t=this.trigger("stop");return t.defaultPrevented?this:(this.is_stopped=!0,this)}},{key:"togglePause",value:function(t){return this.is_paused=void 0===t?!this.is_paused:t,this.trigger(this.is_paused?"pause_enabled":"pause_disabled"),this}},{key:"$launchLoop",value:function(){window.requestAnimationFrame(this.$loop.bind(this))}},{key:"$loop",value:function(){if(this.is_paused)return this;if(this.is_stopped)return this.container=null,this.classes=null,this.layers={},this.current_room.destroy(),this.current_room=null,this.timer.destroy(),this.timer=null,this.inputs.destroy(),this.inputs=null,this;this.$launchLoop();var t=Date.now(),e=t-this.last_loop_time,n=1e3/this.timer.fps;return e<=n?this:(this.timer.trigger("frame"),this.$manageElements(e/1e3),this.$render(),this.last_loop_time=t-e%n,this)}},{key:"$manageElements",value:function(t){var e=this,n=function(n){var i=e.layers[n];i.elements.forEach(function(n){n.is_destroyed||(n.trigger("frame",{delta_time:t}),n.move(t),n.position.round(),n.position.equals(n.prev_position)||n.checkCollisions(e.layers),n.position.equals(n.prev_position)||(e.current_room.getRectangle().isCollidedWithRectangle(n.getRectangle())?(n.is_inside_room||n.trigger("enter_room",{room:e.current_room}),n.is_inside_room=!0):(n.is_inside_room&&n.trigger("leave_room",{room:e.current_room}),n.is_inside_room=!1),i.needs_clear=!0,n.prev_position.copy(n.position)))}),i.elements.filter(function(t){return t.is_destroyed}).forEach(function(t){i.removeElement(t),t.current_tile=null,t.current_animation=null})};for(var i in this.layers)n(i);return this}},{key:"$render",value:function(){for(var t in this.layers){var e=this.layers[t],n=!1;e.needs_clear&&(e.clear(),e.needs_clear=!1,n=!0),e.draw(n)}return this}},{key:"goToRoom",value:function(t){this.current_room=t,t.initRoom(this),this.container.style.width=t.width+"px",this.container.style.height=t.height+"px";for(var e in this.layers){var n=this.layers[e];n.setSize(t.width,t.height)}return t.trigger("start"),this}}]),t}();n.i(l.a)(h),e.a=h},function(t,e,n){"use strict";var i=n(45),r=n(29),o=n(77),s=n(46),a=n(47),u=n(48),c=n(49),l=n(13),h=n(19),f=n(79),p=n(80),d=n(50),v=n(51),y=n(20),_=n(52);e.a={Animation:i.a,Element:r.a,Game:o.a,$http:s.a,Inputs:a.a,Layer:u.a,Mask:c.a,Point:l.a,Rectangle:h.a,Room:f.a,Sprite:p.a,Tile:d.a,Timer:v.a,Trait:y.a,Utils:_.c}},function(t,e,n){"use strict";var i=n(31),r=n.n(i),o=n(90),s=n.n(o),a=n(2),u=n.n(a),c=n(3),l=n.n(c),h=n(19),f=n(46),p=n(9),d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;u()(this,t),this.width=e,this.height=n,this.definition=null}return l()(t,[{key:"destroy",value:function(){return this.definition=null,this.off(),this}},{key:"getRectangle",value:function(){return new h.a(this.width,this.height)}},{key:"getSize",value:function(){var t=this.getRectangle(),e=t.width,n=t.height;return{width:e,height:n}}},{key:"initRoom",value:function(t){var e=this;if(!this.definition)return this;if(this.definition.layers){this.width=0,this.height=0;var n=function(n){var i=e.definition.layers[n],r=t.getLayerFromName(n);if(r.tiles_sprite_class=null,r.tiles=[],i.tiles){var o=t.getClass(i.sprite_class);r.tiles_sprite_class=o,i.tiles.forEach(function(t,e){r.tiles[e]=r.tiles[e]||[],t.forEach(function(t,n){r.tiles[e][n]=o.getTile(t)})}),r.clearTilesAnimations().initTilesAnimations(t.timer);var a=r.tiles_sprite_class.getTilesSize();e.width=Math.max(e.width,r.tiles[0].length*a.width),e.height=Math.max(e.height,r.tiles.length*a.height)}i.elements&&i.elements.forEach(function(e){var n=t.getClass(e.class_name);if(!n)throw new ReferenceError('Class "'+e.class_name+'" found in room definition is not declared or not registered in current game.');var i=e.position||[],r=s()(i,2),o=r[0],a=r[1];new n(o,a,t)})};for(var i in this.definition.layers)n(i)}else this.width=this.definition.width,this.height=this.definition.height;return this}},{key:"useDefinition",value:function(t){var e=this,n=function(n){"string"==typeof t?f.a.get(t,{data_type:f.a.DATA_TYPES.JSON}).then(function(t){e.definition=t,n()}):(e.definition=t,n())};return new r.a(n)}}]),t}();n.i(p.a)(d),e.a=d},function(t,e,n){"use strict";var i=n(54),r=n.n(i),o=n(30),s=n.n(o),a=n(21),u=n.n(a),c=n(31),l=n.n(c),h=n(2),f=n.n(h),p=n(3),d=n.n(p),v=n(50),y=n(45),_=function(){function t(){f()(this,t)}return d()(t,null,[{key:"getTilesSize",value:function(){return{width:this.tiles_width||0,height:this.tiles_height||0}}},{key:"hasTiles",value:function(){return this.tiles.length>0}},{key:"getTile",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t--,!this.hasTiles()||t<0)return v.a.getNewEmptyTile(this);var n=this.tiles,i=n[0].length,r=Math.floor(t/i),o=t%i,s=n[r]?n[r][o]:null;return s?e?n[r][o].clone():n[r][o]:v.a.getNewEmptyTile(this)}},{key:"loadImage",value:function(t){var e=this,n=function(n,i){e.image=new Image,e.image.onload=function(){e.makeTiles(e.image.naturalWidth,e.image.naturalHeight,0),n(e.image)},e.image.onerror=i,e.image.src=t};return new l.a(n)}},{key:"makeTiles",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!this.image)throw ReferenceError(this.name+".makeTiles(): image not found for this class");this.tiles=[],this.tiles_width=t,this.tiles_height=e,this.tiles_separation=n;for(var i=this.image.naturalWidth,r=this.image.naturalHeight,o=1,s=0;s<r;s+=e){var a=s/e;this.tiles[a]=[];for(var u=0;u<i;u+=t)this.tiles[a][u/t]=new v.a(this,u+n*(u/t),s+n*(s/e),o++),i-=n;i=this.image.naturalWidth,r-=n}return this}},{key:"defineTilesAnimations",value:function(t,e){var n=this;return this.animations={},t.forEach(function(t){n.animations[t.name||u()()]=y.a.define(e,t.tiles,t.time,t.name)}),this}},{key:"getAnimationClass",value:function(t){return this.animations[t]||null}},{key:"defineTilesTypes",value:function(t){var e=this,n=Array.prototype.concat(s()(t),r()(t));return n.forEach(function(n){var i=t[n];i.forEach(function(t){var i=e.getTile(t,!1);i.type=n})}),this}},{key:"defineTilesSlopes",value:function(t){for(var e in t){var n=this.getTile(e,!1);n.type=v.a.TYPES.SLOPE,n.slope_point=t[e]}return this}}]),t}();_.image=null,_.tiles=[],_.tiles_width=0,_.tiles_height=0,_.animations={},e.a=_},function(t,e,n){"use strict";var i=n(20),r=n(29),o=n.i(i.a)({initKeysMap:function(t){if(!this instanceof r.a)throw new TypeError("Trait Keys_Mapping: trying to make playable a non-Element instance");this.useKeysMapping(t)},useKeysMapping:function(t){return this.$keys_mapping=t,this},isActionKeyPressed:function(t,e){var n=this.$keys_mapping[e]||[];return n instanceof Array?n.some(function(e){return t.isKeyPressed(e)}):t.isKeyPressed(n)},isKeyBindedToAction:function(t,e){var n=this.$keys_mapping[e]||[];return n instanceof Array?n.indexOf(t)>=0:n===t}});e.a=o},function(t,e,n){"use strict";var i=n(20),r=n(29),o=n.i(i.a)({initMoveWrap:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this instanceof r.a)throw new TypeError("Trait Move_Wrap: trying to init move wrap feature on non-Element instance");return this.on("leave_room",function(i){var r=t.getSize();n&&(t.position.y+r.height<=0?t.position.y=i.detail.room.height:t.position.y>=i.detail.room.height&&(t.position.y=-r.height)),e&&(t.position.x+r.width<=0?t.position.x=i.detail.room.width:t.position.x>=i.detail.room.width&&(t.position.x=-r.width))}),this}});e.a=o},function(t,e,n){t.exports={default:n(91),__esModule:!0}},function(t,e,n){t.exports={default:n(92),__esModule:!0}},function(t,e,n){t.exports={default:n(93),__esModule:!0}},function(t,e,n){t.exports={default:n(94),__esModule:!0}},function(t,e,n){t.exports={default:n(95),__esModule:!0}},function(t,e,n){t.exports={default:n(99),__esModule:!0}},function(t,e,n){t.exports={default:n(102),__esModule:!0}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(84),o=i(r),s=n(83),a=i(s);e.default=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var s,u=(0,a.default)(t);!(i=(s=u.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&u.return&&u.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if((0,o.default)(Object(e)))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(t,e,n){n(28),n(27),t.exports=n(127)},function(t,e,n){n(28),n(27),t.exports=n(128)},function(t,e,n){n(130),t.exports=n(0).Math.sign},function(t,e,n){n(131);var i=n(0).Object;t.exports=function(t,e){return i.create(t,e)}},function(t,e,n){n(132);var i=n(0).Object;t.exports=function(t,e,n){return i.defineProperty(t,e,n)}},function(t,e,n){n(133);var i=n(0).Object;t.exports=function(t){return i.getOwnPropertyNames(t)}},function(t,e,n){n(75),t.exports=n(0).Object.getOwnPropertySymbols},function(t,e,n){n(134),t.exports=n(0).Object.getPrototypeOf},function(t,e,n){n(135),t.exports=n(0).Object.setPrototypeOf},function(t,e,n){n(74),n(27),n(28),n(136),t.exports=n(0).Promise},function(t,e,n){n(75),n(74),n(137),n(138),t.exports=n(0).Symbol},function(t,e,n){n(27),n(28),t.exports=n(44).f("iterator")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var i=n(12),r=n(71),o=n(126);t.exports=function(t){return function(e,n,s){var a,u=i(e),c=r(u.length),l=o(s,c);if(t&&n!=n){for(;c>l;)if(a=u[l++],a!=a)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}}},function(t,e,n){var i=n(23),r=n(65),o=n(38);t.exports=function(t){var e=i(t),n=r.f;if(n)for(var s,a=n(t),u=o.f,c=0;a.length>c;)u.call(t,s=a[c++])&&e.push(s);return e}},function(t,e,n){var i=n(17),r=n(112),o=n(110),s=n(5),a=n(71),u=n(73),c={},l={},e=t.exports=function(t,e,n,h,f){var p,d,v,y,_=f?function(){return t}:u(t),m=i(n,h,e?2:1),g=0;if("function"!=typeof _)throw TypeError(t+" is not iterable!");if(o(_)){for(p=a(t.length);p>g;g++)if(y=e?m(s(d=t[g])[0],d[1]):m(t[g]),y===c||y===l)return y}else for(v=_.call(t);!(d=v.next()).done;)if(y=r(v,m,d.value,e),y===c||y===l)return y};e.BREAK=c,e.RETURN=l},function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var i=n(16);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e,n){var i=n(15),r=n(1)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}},function(t,e,n){var i=n(16);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&i(o.call(t)),e}}},function(t,e,n){"use strict";var i=n(37),r=n(24),o=n(25),s={};n(11)(s,n(1)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i(s,{next:r(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var i=n(1)("iterator"),r=!1;try{var o=[7][i]();o.return=function(){r=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var o=[7],s=o[i]();s.next=function(){return{done:n=!0}},o[i]=function(){return s},t(o)}catch(t){}return n}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){var i=n(23),r=n(12);t.exports=function(t,e){for(var n,o=r(t),s=i(o),a=s.length,u=0;a>u;)if(o[n=s[u++]]===e)return n}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e,n){var i=n(26)("meta"),r=n(14),o=n(10),s=n(8).f,a=0,u=Object.isExtensible||function(){return!0},c=!n(18)(function(){return u(Object.preventExtensions({}))}),l=function(t){s(t,i,{value:{i:"O"+ ++a,w:{}}})},h=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,i)){if(!u(t))return"F";if(!e)return"E";l(t)}return t[i].i},f=function(t,e){if(!o(t,i)){if(!u(t))return!0;if(!e)return!1;l(t)}return t[i].w},p=function(t){return c&&d.NEED&&u(t)&&!o(t,i)&&l(t),t},d=t.exports={KEY:i,NEED:!1,fastKey:h,getWeak:f,onFreeze:p}},function(t,e,n){var i=n(4),r=n(70).set,o=i.MutationObserver||i.WebKitMutationObserver,s=i.process,a=i.Promise,u="process"==n(16)(s);t.exports=function(){var t,e,n,c=function(){var i,r;for(u&&(i=s.domain)&&i.exit();t;){r=t.fn,t=t.next;try{r()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(u)n=function(){s.nextTick(c)};else if(o){var l=!0,h=document.createTextNode("");new o(c).observe(h,{characterData:!0}),n=function(){h.data=l=!l}}else if(a&&a.resolve){var f=a.resolve();n=function(){f.then(c)}}else n=function(){r.call(i,c)};return function(i){var r={fn:i,next:void 0};e&&(e.next=r),t||(t=r,n()),e=r}}},function(t,e,n){var i=n(8),r=n(5),o=n(23);t.exports=n(6)?Object.defineProperties:function(t,e){r(t);for(var n,s=o(e),a=s.length,u=0;a>u;)i.f(t,n=s[u++],e[n]);return t}},function(t,e,n){var i=n(11);t.exports=function(t,e,n){for(var r in e)n&&t[r]?t[r]=e[r]:i(t,r,e[r]);return t}},function(t,e,n){var i=n(14),r=n(5),o=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n(17)(Function.call,n(62).f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:o}},function(t,e,n){"use strict";var i=n(4),r=n(0),o=n(8),s=n(6),a=n(1)("species");t.exports=function(t){var e="function"==typeof r[t]?r[t]:i[t];s&&e&&!e[a]&&o.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){var i=n(5),r=n(32),o=n(1)("species");t.exports=function(t,e){var n,s=i(t).constructor;return void 0===s||void 0==(n=i(s)[o])?e:r(n)}},function(t,e,n){var i=n(41),r=n(34);t.exports=function(t){return function(e,n){var o,s,a=String(r(e)),u=i(n),c=a.length;return u<0||u>=c?t?"":void 0:(o=a.charCodeAt(u),o<55296||o>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?t?a.charAt(u):o:t?a.slice(u,u+2):(o-55296<<10)+(s-56320)+65536)}}},function(t,e,n){var i=n(41),r=Math.max,o=Math.min;t.exports=function(t,e){return t=i(t),t<0?r(t+e,0):o(t,e)}},function(t,e,n){var i=n(5),r=n(73);t.exports=n(0).getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},function(t,e,n){var i=n(33),r=n(1)("iterator"),o=n(15);t.exports=n(0).isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||o.hasOwnProperty(i(e))}},function(t,e,n){"use strict";var i=n(103),r=n(115),o=n(15),s=n(12);t.exports=n(61)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):"keys"==e?r(0,n):"values"==e?r(0,t[n]):r(0,[n,t[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t,e,n){var i=n(7);i(i.S,"Math",{sign:n(117)})},function(t,e,n){var i=n(7);i(i.S,"Object",{create:n(37)})},function(t,e,n){var i=n(7);i(i.S+i.F*!n(6),"Object",{defineProperty:n(8).f})},function(t,e,n){n(68)("getOwnPropertyNames",function(){return n(63).f})},function(t,e,n){var i=n(72),r=n(66);n(68)("getPrototypeOf",function(){return function(t){return r(i(t))}})},function(t,e,n){var i=n(7);i(i.S,"Object",{setPrototypeOf:n(122).set})},function(t,e,n){"use strict";var i,r,o,s=n(22),a=n(4),u=n(17),c=n(33),l=n(7),h=n(14),f=n(32),p=n(104),d=n(107),v=n(124),y=n(70).set,_=n(119)(),m="Promise",g=a.TypeError,w=a.process,k=a[m],w=a.process,x="process"==c(w),b=function(){},E=!!function(){try{var t=k.resolve(1),e=(t.constructor={})[n(1)("species")]=function(t){t(b,b)};return(x||"function"==typeof PromiseRejectionEvent)&&t.then(b)instanceof e}catch(t){}}(),S=function(t,e){return t===e||t===k&&e===o},T=function(t){var e;return!(!h(t)||"function"!=typeof(e=t.then))&&e},O=function(t){return S(k,t)?new M(t):new r(t)},M=r=function(t){var e,n;this.promise=new t(function(t,i){if(void 0!==e||void 0!==n)throw g("Bad Promise constructor");e=t,n=i}),this.resolve=f(e),this.reject=f(n)},P=function(t){try{t()}catch(t){return{error:t}}},N=function(t,e){if(!t._n){t._n=!0;var n=t._c;_(function(){for(var i=t._v,r=1==t._s,o=0,s=function(e){var n,o,s=r?e.ok:e.fail,a=e.resolve,u=e.reject,c=e.domain;try{s?(r||(2==t._h&&j(t),t._h=1),s===!0?n=i:(c&&c.enter(),n=s(i),c&&c.exit()),n===e.promise?u(g("Promise-chain cycle")):(o=T(n))?o.call(n,a,u):a(n)):u(i)}catch(t){u(t)}};n.length>o;)s(n[o++]);t._c=[],t._n=!1,e&&!t._h&&A(t)})}},A=function(t){y.call(a,function(){var e,n,i,r=t._v;if(R(t)&&(e=P(function(){x?w.emit("unhandledRejection",r,t):(n=a.onunhandledrejection)?n({promise:t,reason:r}):(i=a.console)&&i.error&&i.error("Unhandled promise rejection",r)}),t._h=x||R(t)?2:1),t._a=void 0,e)throw e.error})},R=function(t){if(1==t._h)return!1;for(var e,n=t._a||t._c,i=0;n.length>i;)if(e=n[i++],e.fail||!R(e.promise))return!1;return!0},j=function(t){y.call(a,function(){var e;x?w.emit("rejectionHandled",t):(e=a.onrejectionhandled)&&e({promise:t,reason:t._v})})},C=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),N(e,!0))},L=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw g("Promise can't be resolved itself");(e=T(t))?_(function(){var i={_w:n,_d:!1};try{e.call(t,u(L,i,1),u(C,i,1))}catch(t){C.call(i,t)}}):(n._v=t,n._s=1,N(n,!1))}catch(t){C.call({_w:n,_d:!1},t)}}};E||(k=function(t){p(this,k,m,"_h"),f(t),i.call(this);try{t(u(L,this,1),u(C,this,1))}catch(t){C.call(this,t)}},i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},i.prototype=n(121)(k.prototype,{then:function(t,e){var n=O(v(this,k));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=x?w.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&N(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),M=function(){var t=new i;this.promise=t,this.resolve=u(L,t,1),this.reject=u(C,t,1)}),l(l.G+l.W+l.F*!E,{Promise:k}),n(25)(k,m),n(123)(m),o=n(0)[m],l(l.S+l.F*!E,m,{reject:function(t){var e=O(this),n=e.reject;return n(t),e.promise}}),l(l.S+l.F*(s||!E),m,{resolve:function(t){if(t instanceof k&&S(t.constructor,this))return t;var e=O(this),n=e.resolve;return n(t),e.promise}}),l(l.S+l.F*!(E&&n(114)(function(t){k.all(t).catch(b)})),m,{all:function(t){var e=this,n=O(e),i=n.resolve,r=n.reject,o=P(function(){var n=[],o=0,s=1;d(t,!1,function(t){var a=o++,u=!1;n.push(void 0),s++,e.resolve(t).then(function(t){u||(u=!0,n[a]=t,--s||i(n))},r)}),--s||i(n)});return o&&r(o.error),n.promise},race:function(t){var e=this,n=O(e),i=n.reject,r=P(function(){d(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return r&&i(r.error),n.promise}})},function(t,e,n){n(43)("asyncIterator")},function(t,e,n){n(43)("observable")},function(t,e,n){t.exports=n(76)}])});