{"version":3,"sources":["../../jsglib/room.js"],"names":[],"mappings":"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","file":"room.js","sourcesContent":["(function(window) {\r\n    \"use strict\";\r\n\r\n    let JSGlib = window.JSGlib || {};\r\n\r\n    class Room extends JSGlib.EventsHandler {\r\n        constructor(width = 0, height = 0) {\r\n            super();\r\n\t\t\tthis.width = width;\r\n\t\t\tthis.height = height;\r\n\t\t\tthis.definition = null;\r\n        }\r\n\t\tinitRoom(game) {\r\n\t\t\tif ( ! this.definition) {\r\n\t\t\t\treturn this;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.definition.layers) {\r\n\t\t\t\tthis.width = 0;\r\n\t\t\t\tthis.height = 0;\r\n\r\n\t\t\t\tfor (let layer_name in this.definition.layers) {\r\n\t\t\t\t\tlet definition = this.definition.layers[layer_name];\r\n\t\t\t\t\tlet layer = game.getLayerFromName(layer_name);\r\n\t\t\t\t\tlayer.tiles_sprite = null;\r\n\t\t\t\t\tlayer.tiles = [];\r\n\r\n\t\t\t\t\tif (definition.tiles) {\r\n\t\t\t\t\t\tlet SpriteClass = game.getClass(definition.sprite_class);\r\n\t\t\t\t\t\tlayer.tiles_sprite = new SpriteClass();\r\n\r\n\t\t\t\t\t\tdefinition.tiles.forEach((row, row_index) => {\r\n\t\t\t\t\t\t\tlayer.tiles[row_index] = layer.tiles[row_index] || [];\r\n\r\n\t\t\t\t\t\t\trow.forEach((tile_number, column_index) => {\r\n\t\t\t\t\t\t\t\tlayer.tiles[row_index][column_index] = SpriteClass.getTile(tile_number);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tlet tiles_size = layer.tiles_sprite.getTilesSize();\r\n\t\t\t\t\t\tthis.width = Math.max(this.width, layer.tiles[0].length * tiles_size.width);\r\n\t\t\t\t\t\tthis.height = Math.max(this.height, layer.tiles.length * tiles_size.height);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.width = this.definition.width;\r\n\t\t\t\tthis.height = this.definition.height;\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n        useDefinition(data) {\r\n\t\t\tlet promise = (resolve) => {\r\n\t\t\t\tif (typeof data === 'string') {\r\n\t\t\t\t\tJSGlib.http.get(data, {data_type: JSGlib.http.DATA_TYPES.JSON}).then(data => {\r\n\t\t\t\t\t\tthis.definition = data;\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.definition = data;\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\treturn new Promise(promise);\r\n        }\r\n    }\r\n\r\n\tJSGlib.Room = Room;\r\n\r\n    window.JSGlib = JSGlib;\r\n})(window);"]}