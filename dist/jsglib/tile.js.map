{"version":3,"sources":["../../jsglib/tile.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAKqB,IAAI;YAAJ,IAAI;;WAAJ,IAAI;;;;yBAAJ,IAAI;;sEAAJ,IAAI;;;;;;;;;eAAJ,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;SAAJ,IAAI;;;mBAAJ,IAAI","file":"tile.js","sourcesContent":["\"use strict\";\r\n\r\nimport EventsHandler from \"jsglib/events_handler\";\r\nimport Point from \"jsglib/point\";\r\n\r\nexport default class Tile extends EventsHandler {\r\n\tconstructor(sprite_class, x = 0, y = 0) {\r\n\t\tsuper();\r\n\r\n\t\tthis.sprite_class = sprite_class;\r\n\t\tthis.position = new Point(x, y);\r\n\t\tthis.needs_redraw = true;\r\n\t\tthis.clock_animation = null;\r\n\t}\r\n\tclone() {\r\n\t\tlet new_tile = new Tile(this.sprite_class, this.position.x, this.position.y);\r\n\r\n\t\tif (this.animation) {\r\n\t\t\tlet {next_tile_number, time} = this.animation;\r\n\t\t\tnew_tile.animation = {next_tile_number, time};\r\n\t\t}\r\n\r\n\t\treturn new_tile;\r\n\t}\r\n\tdraw(ctx, x = 0, y = 0, timer) {\r\n\t\tlet tiles_size = {\r\n\t\t\twidth: this.sprite_class.tiles_width,\r\n\t\t\theight: this.sprite_class.tiles_height\r\n\t\t};\r\n\r\n\t\tlet dest_x = x * tiles_size.height;\r\n\t\tlet dest_y = y * tiles_size.width;\r\n\r\n\t\tctx.clearRect(dest_x, dest_y, tiles_size.width, tiles_size.height);\r\n\t\tctx.drawImage(\r\n\t\t\tthis.sprite_class.image,\r\n\t\t\tthis.position.x,\r\n\t\t\tthis.position.y,\r\n\t\t\ttiles_size.width,\r\n\t\t\ttiles_size.height,\r\n\t\t\tdest_x,\r\n\t\t\tdest_y,\r\n\t\t\ttiles_size.width,\r\n\t\t\ttiles_size.height\r\n\t\t);\r\n\r\n\t\tthis.needs_redraw = false;\r\n\r\n\t\tif (this.animation) {\r\n\t\t\tif (this.clock_animation) {\r\n\t\t\t\ttimer.clearTimeout(this.clock_animation);\r\n\t\t\t}\r\n\r\n\t\t\tthis.clock_animation = timer.setTimeout(() => {\r\n\t\t\t\tthis.trigger('animation');\r\n\t\t\t}, this.animation.time);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\tsetAnimation(next_tile_number, time) {\r\n\t\tthis.animation = {next_tile_number, time};\r\n\t\treturn this;\r\n\t}\r\n}"]}