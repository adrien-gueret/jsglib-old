{"version":3,"sources":["../../jsglib/layer.js"],"names":[],"mappings":"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","file":"layer.js","sourcesContent":["(function(window) {\r\n    \"use strict\";\r\n\r\n    let JSGlib = window.JSGlib || {};\r\n\r\n    class Layer {\r\n\t\tconstructor(name) {\r\n\t\t\tthis.name = name;\r\n\r\n\t\t\tthis.canvas = document.createElement('canvas');\r\n\t\t\tthis.ctx = this.canvas.getContext('2d');\r\n\t\t\tthis.canvas.setAttribute('data-name', this.name);\r\n\t\t\tthis.canvas.style.position = 'absolute';\r\n\t\t\tthis.canvas.style.left = 0;\r\n\t\t\tthis.canvas.style.top = 0;\r\n\t\t\tthis.canvas.style.zIndex = 0;\r\n\r\n\t\t\tthis.tiles_sprite = null;\r\n\t\t\tthis.tiles = [];\r\n\t\t}\r\n\t\tsetSize(width, height) {\r\n\t\t\tthis.canvas.width = width;\r\n\t\t\tthis.canvas.height = height;\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tsetZindex(new_zindex) {\r\n\t\t\tthis.canvas.style.zIndex = new_zindex;\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tdraw(timer, force_redraw = false) {\r\n\t\t\tthis.tiles.forEach((row, row_index) => {\r\n\t\t\t\trow.forEach((tile, column_index) => {\r\n\t\t\t\t\t// If empty tile, we skip it\r\n\t\t\t\t\tif (!tile || !tile.sprite_class) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Draw tile only if we need it\r\n\t\t\t\t\tif (!force_redraw && !tile.needs_redraw) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttile\r\n\t\t\t\t\t\t.draw(this.ctx, column_index, row_index, timer)\r\n\t\t\t\t\t\t.on('animation', () => {\r\n\t\t\t\t\t\t\tthis.tiles[row_index][column_index] = tile.sprite_class.getTile(tile.animation.next_tile_number);\r\n\t\t\t\t\t\t\ttile.off('animaiton');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tclear() {\r\n\t\t\tthis.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n\t\t\treturn this;\r\n\t\t}\r\n    }\r\n\tLayer.MAIN_LAYER = new Layer('MAIN_LAYER');\r\n\tLayer.TILES_LAYER = new Layer('TILES_LAYER');\r\n\tLayer.BACKGROUND_LAYER = new Layer('BACKGROUND_LAYER');\r\n\r\n\tJSGlib.Layer = Layer;\r\n\twindow.JSGlib = JSGlib;\r\n})(window);"]}