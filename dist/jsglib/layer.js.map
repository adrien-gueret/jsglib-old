{"version":3,"sources":["../../jsglib/layer.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;mBA2De,KAAK","file":"layer.js","sourcesContent":["\"use strict\";\r\n\r\nclass Layer {\r\n\tconstructor(name) {\r\n\t\tthis.name = name;\r\n\r\n\t\tthis.canvas = document.createElement('canvas');\r\n\t\tthis.ctx = this.canvas.getContext('2d');\r\n\t\tthis.canvas.setAttribute('data-name', this.name);\r\n\t\tthis.canvas.style.position = 'absolute';\r\n\t\tthis.canvas.style.left = 0;\r\n\t\tthis.canvas.style.top = 0;\r\n\t\tthis.canvas.style.zIndex = 0;\r\n\r\n\t\tthis.tiles_sprite = null;\r\n\t\tthis.tiles = [];\r\n\t}\r\n\tsetSize(width, height) {\r\n\t\tthis.canvas.width = width;\r\n\t\tthis.canvas.height = height;\r\n\t\treturn this;\r\n\t}\r\n\tsetZindex(new_zindex) {\r\n\t\tthis.canvas.style.zIndex = new_zindex;\r\n\t\treturn this;\r\n\t}\r\n\tdraw(timer, force_redraw = false) {\r\n\t\tthis.tiles.forEach((row, row_index) => {\r\n\t\t\trow.forEach((tile, column_index) => {\r\n\t\t\t\t// If empty tile, we skip it\r\n\t\t\t\tif (!tile || !tile.sprite_class) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Draw tile only if we need it\r\n\t\t\t\tif (!force_redraw && !tile.needs_redraw) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttile\r\n\t\t\t\t\t.draw(this.ctx, column_index, row_index, timer)\r\n\t\t\t\t\t.on('animation', () => {\r\n\t\t\t\t\t\tthis.tiles[row_index][column_index] = tile.sprite_class.getTile(tile.animation.next_tile_number);\r\n\t\t\t\t\t\ttile.off('animaiton');\r\n\t\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn this;\r\n\t}\r\n\tclear() {\r\n\t\tthis.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n\t\treturn this;\r\n\t}\r\n}\r\nLayer.MAIN_LAYER = new Layer('MAIN_LAYER');\r\nLayer.TILES_LAYER = new Layer('TILES_LAYER');\r\nLayer.BACKGROUND_LAYER = new Layer('BACKGROUND_LAYER');\r\n\r\nexport default Layer;"]}