{"version":3,"sources":["../../jsglib/layer.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sBA+De,KAAK","file":"layer.js","sourcesContent":["\"use strict\";\r\n\r\nclass Layer {\r\n    constructor(name) {\r\n        this.name = name;\r\n\r\n        this.canvas = document.createElement('canvas');\r\n        this.ctx = this.canvas.getContext('2d');\r\n        this.canvas.setAttribute('data-name', this.name);\r\n        this.canvas.style.position = 'absolute';\r\n        this.canvas.style.left = 0;\r\n        this.canvas.style.top = 0;\r\n        this.canvas.style.zIndex = 0;\r\n\r\n        this.tiles_sprite = null;\r\n        this.tiles = [];\r\n    }\r\n\r\n    setSize(width, height) {\r\n        this.canvas.width = width;\r\n        this.canvas.height = height;\r\n        return this;\r\n    }\r\n\r\n    setZindex(new_zindex) {\r\n        this.canvas.style.zIndex = new_zindex;\r\n        return this;\r\n    }\r\n\r\n    draw(timer, force_redraw = false) {\r\n        this.tiles.forEach((row, row_index) => {\r\n            row.forEach((tile, column_index) => {\r\n                // If empty tile, we skip it\r\n                if (!tile || !tile.sprite_class) {\r\n                    return;\r\n                }\r\n\r\n                // Draw tile only if we need it\r\n                if (!force_redraw && !tile.needs_redraw) {\r\n                    return;\r\n                }\r\n\r\n                tile\r\n                    .draw(this.ctx, column_index, row_index, timer)\r\n                    .on('animation', () => {\r\n                        this.tiles[row_index][column_index] = tile.sprite_class.getTile(tile.animation.next_tile_number);\r\n                        tile.off('animaiton');\r\n                    });\r\n            });\r\n        });\r\n\r\n        return this;\r\n    }\r\n\r\n    clear() {\r\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n        return this;\r\n    }\r\n}\r\nLayer.MAIN_LAYER = new Layer('MAIN_LAYER');\r\nLayer.TILES_LAYER = new Layer('TILES_LAYER');\r\nLayer.BACKGROUND_LAYER = new Layer('BACKGROUND_LAYER');\r\n\r\nexport default Layer;"]}