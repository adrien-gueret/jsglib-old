{"version":3,"sources":["../../jsglib/http.js"],"names":[],"mappings":"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","file":"http.js","sourcesContent":["(function(window, undefined) {\r\n    \"use strict\";\r\n\r\n    let JSGlib = window.JSGlib || {};\r\n\r\n    const METHOD_GET = 'GET';\r\n    const METHOD_POST = 'POST';\r\n    const METHOD_PUT = 'PUT';\r\n    const METHOD_DELETE = 'DELETE';\r\n    const DATA_TYPE_TEXT = 'TEXT';\r\n    const DATA_TYPE_JSON = 'JSON';\r\n    const DATA_TYPE_XML = 'XML';\r\n\r\n    function getParamsStringFromData(data) {\r\n        var params = [];\r\n\r\n        for (let param in data) {\r\n            if (data.hasOwnProperty(param)) {\r\n                params.push(encodeURIComponent(param) + '=' + encodeURIComponent(data[param]));\r\n            }\r\n        }\r\n\r\n        return params.join('&');\r\n    }\r\n\r\n    function getReadyStateChangeHandler(xhr, data_type, resolve, reject) {\r\n        return () => {\r\n            if (xhr.readyState === 4) {\r\n                if (xhr.status === 200 || xhr.status === 304) {\r\n                    let response;\r\n\r\n                    switch(data_type) {\r\n                        case DATA_TYPE_JSON:\r\n                            response = JSON.parse(xhr.responseText);\r\n                        break;\r\n\r\n                        case DATA_TYPE_XML:\r\n                            response = xhr.responseXML;\r\n                        break;\r\n\r\n                        default:\r\n                            response = xhr.responseText;\r\n                        break;\r\n                    }\r\n\r\n                    resolve(response);\r\n                }\r\n                else {\r\n                    reject(xhr);\r\n                }\r\n            }\r\n        };\r\n    }\r\n\r\n    function performRequest(method, url, data = undefined, async = true, data_type = DATA_TYPE_TEXT) {\r\n        let promise = (resolve, reject) => {\r\n            let xhr = new XMLHttpRequest();\r\n            let params_string = null;\r\n\r\n            if (data) {\r\n                params_string = getParamsStringFromData(data);\r\n            }\r\n\r\n            if (params_string && method === METHOD_GET) {\r\n                url += url.indexOf('?') === -1 ? '?' : '&';\r\n                url += params_string;\r\n            }\r\n\r\n            xhr.onreadystatechange = getReadyStateChangeHandler(xhr, data_type, resolve, reject);\r\n            xhr.open(method, url, async);\r\n            xhr.send(method === METHOD_POST ? params_string : null);\r\n        };\r\n\r\n        return new Promise(promise);\r\n    }\r\n\r\n    function getExposedMethod(request_method) {\r\n        return (url,  {data = undefined, async = true, data_type = DATA_TYPE_TEXT} = {}) => {\r\n            return performRequest(request_method, url, data, async, data_type);\r\n        };\r\n    }\r\n\r\n    JSGlib.http = {\r\n        DATA_TYPES: {\r\n          TEXT: DATA_TYPE_TEXT,\r\n          XML: DATA_TYPE_XML,\r\n          JSON: DATA_TYPE_JSON\r\n        },\r\n        get: getExposedMethod(METHOD_GET),\r\n        post: getExposedMethod(METHOD_POST),\r\n        delete: getExposedMethod(METHOD_DELETE),\r\n        put: getExposedMethod(METHOD_PUT)\r\n    };\r\n\r\n    window.JSGlib = JSGlib;\r\n})(window);"]}